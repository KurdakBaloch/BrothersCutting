<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brothers Cutting & Coring</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        // Make jsPDF globally available
        window.jsPDF = window.jspdf.jsPDF;
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            background: white;
            padding: 3rem 1.5rem 1.5rem 1.5rem;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 400px;
            min-height: 550px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }
        
        .screen {
            display: none;
        }
        
        .screen.active {
            display: block;
        }
        
        h1, h2 {
            text-align: center;
            margin-bottom: 1.5rem;
            color: #333;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: #555;
        }
        
        input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 5px rgba(102, 126, 234, 0.3);
        }
        
        .btn {
            width: 100%;
            padding: 0.75rem;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 1rem;
        }
        
        .btn:hover {
            background: #5a6fd8;
        }
        
        .error {
            color: red;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }
        
        .success {
            color: green;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }
        
        .dashboard {
            text-align: center;
        }
        
        .user-info {
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
        }
        
        .btn-secondary {
            background: #6c757d;
            margin-top: 0.5rem;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-success {
            background: #28a745;
            margin-top: 0.5rem;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .job-list {
            text-align: left;
            margin-top: 1rem;
        }
        
        .job-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            transition: all 0.2s ease;
        }
        
        .job-card:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-color: #667eea;
        }
        
        .job-card.job-conflict {
            border-color: #dc3545;
            background: #fff5f5;
        }
        
        .job-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .job-card h4 {
            color: #495057;
            margin: 0;
        }
        
        .conflict-flag {
            background: #dc3545;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            font-size: 0.8rem;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .job-details {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 0.75rem;
        }
        
        .conflict-details {
            color: #dc3545;
            font-weight: bold;
        }
        
        .job-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
            padding-top: 0.5rem;
            border-top: 1px solid #e9ecef;
        }
        
        .btn-action {
            background: none;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 0.4rem 0.8rem;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        
        .btn-action:hover {
            background: #f8f9fa;
            border-color: #adb5bd;
        }
        
        .btn-edit:hover {
            background: #e7f3ff;
            border-color: #007bff;
            color: #007bff;
        }
        
        .btn-delete:hover {
            background: #fff5f5;
            border-color: #dc3545;
            color: #dc3545;
        }
        
        /* Mobile responsive adjustments */
        @media (max-width: 600px) {
            .job-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .job-actions {
                justify-content: center;
            }
            
            .btn-action {
                flex: 1;
                justify-content: center;
            }
        }

        /* Equipment Management Styles */
        .equipment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e9ecef;
        }

        .equipment-header h3 {
            margin: 0;
            color: #333;
        }

        .equipment-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .category-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            border: 1px solid #e9ecef;
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #dee2e6;
        }

        .category-header h4 {
            margin: 0;
            color: #495057;
            font-size: 1.1rem;
        }

        .btn-category-add {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 0.25rem 0.75rem;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-category-add:hover {
            background: #218838;
            transform: translateY(-1px);
        }

        .equipment-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .equipment-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 0.75rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }

        .equipment-item:hover {
            border-color: #007bff;
            box-shadow: 0 2px 8px rgba(0,123,255,0.1);
        }

        .equipment-info {
            flex: 1;
        }

        .equipment-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.25rem;
        }

        .equipment-description {
            font-size: 0.9rem;
            color: #6c757d;
            margin: 0;
        }

        .equipment-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-equipment {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
            border: 1px solid #dee2e6;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-equipment:hover {
            background: #f8f9fa;
        }

        .btn-edit-equipment:hover {
            border-color: #007bff;
            color: #007bff;
        }

        .btn-delete-equipment:hover {
            border-color: #dc3545;
            color: #dc3545;
        }

        /* Mobile responsive for equipment */
        @media (max-width: 600px) {
            .equipment-categories {
                grid-template-columns: 1fr;
            }
            
            .equipment-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .category-header {
                flex-direction: column;
                gap: 0.5rem;
                align-items: stretch;
            }
            
            .btn-category-add {
                align-self: flex-end;
            }
            
            .equipment-item {
                flex-direction: column;
                align-items: stretch;
                gap: 0.5rem;
            }
            
            .equipment-actions {
                justify-content: center;
            }
        }

        /* Enhanced Crew Dashboard Styles */
        .crew-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .crew-header h2 {
            margin: 0 0 0.5rem 0;
            font-size: 1.8rem;
        }

        /* Brothers Cutting & Coring Logo */
        .company-logo {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 1rem;
        }

        .logo-gradient-bar {
            width: 200px;
            height: 8px;
            background: linear-gradient(90deg, #4a90e2 0%, #5a4fcf 100%);
            border-radius: 4px;
            margin-bottom: 0.5rem;
        }

        .logo-text {
            text-align: center;
            line-height: 1.2;
        }

        .logo-main-text {
            font-size: 2.5rem;
            font-weight: bold;
            color: #1e3a8a;
            margin: 0;
            letter-spacing: 2px;
        }

        .logo-divider {
            width: 120px;
            height: 2px;
            background: #000;
            margin: 0.5rem auto;
        }

        .logo-sub-text {
            font-size: 1.2rem;
            font-weight: bold;
            color: #1e3a8a;
            margin: 0;
            letter-spacing: 1px;
        }

        /* White text for specific headings */
        .white-text {
            color: white !important;
        }

        .white-text .logo-main-text,
        .white-text .logo-sub-text {
            color: white !important;
        }

        .white-text .logo-divider {
            background: white;
        }

        /* Logo image styles */
        .company-logo-image {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 1.5rem;
            margin-top: 0.5rem;
        }

        .logo-img {
            max-width: 400px;
            width: 100%;
            height: auto;
            object-fit: contain;
        }

        /* Responsive logo sizing */
        @media (max-width: 768px) {
            .logo-img {
                max-width: 320px;
            }
        }

        @media (max-width: 480px) {
            .logo-img {
                max-width: 280px;
            }
        }

        .crew-user-info {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .crew-user-info strong {
            font-size: 1.1rem;
        }

        .crew-user-info span {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .crew-dashboard-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 1rem;
            min-height: calc(100vh - 200px);
            overflow-x: hidden;
        }

        /* Ensure proper viewport containment */
        .crew-dashboard {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .crew-dashboard-header {
            flex-shrink: 0;
        }

        .crew-dashboard-content {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 2rem;
        }

        .crew-tab-navigation {
            display: flex;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 0.2rem;
            margin-bottom: 1.5rem;
            gap: 0.15rem;
            width: 100%;
            min-width: 0;
        }

        .crew-tab-navigation::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }

        .crew-tab-btn {
            flex: 1;
            min-width: 0;
            background: none;
            border: none;
            padding: 0.6rem 0.5rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            color: #6c757d;
            transition: all 0.2s ease;
            white-space: nowrap;
            text-align: center;
        }

        .crew-tab-btn.active {
            background: white;
            color: #495057;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .crew-tab-btn:hover:not(.active) {
            background: rgba(255,255,255,0.5);
            color: #495057;
        }

        .crew-tab-content {
            display: none;
        }

        .crew-tab-content.active {
            display: block;
        }

        .crew-jobs-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e9ecef;
        }

        .crew-jobs-header h3 {
            margin: 0;
            color: #333;
            font-size: 1.3rem;
        }

        .crew-time-display {
            background: #007bff;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .crew-date-range {
            color: #6c757d;
            font-size: 0.9rem;
            font-style: italic;
        }

        .crew-job-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .crew-job-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            padding: 1.25rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .crew-job-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        }

        .crew-job-card.upcoming {
            border-left: 4px solid #007bff;
        }

        .crew-job-card.in-progress {
            border-left: 4px solid #28a745;
            background: linear-gradient(135deg, #f8fff9 0%, #ffffff 100%);
        }

        .crew-job-card.completed {
            border-left: 4px solid #6c757d;
            opacity: 0.8;
        }

        .crew-job-card.overdue {
            border-left: 4px solid #dc3545;
            background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%);
        }

        .crew-job-status {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-upcoming {
            background: #e7f3ff;
            color: #007bff;
        }

        .status-in-progress {
            background: #d4edda;
            color: #155724;
        }

        .status-completed {
            background: #e2e3e5;
            color: #383d41;
        }

        .status-overdue {
            background: #f8d7da;
            color: #721c24;
        }

        .crew-job-time {
            font-size: 1.1rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .crew-job-address {
            font-size: 1rem;
            color: #495057;
            margin-bottom: 0.75rem;
            line-height: 1.4;
        }

        .crew-job-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .crew-job-detail {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: #6c757d;
        }

        .crew-job-detail-icon {
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .crew-job-tools {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 0.75rem;
            margin-bottom: 1rem;
        }

        .crew-job-tools h5 {
            margin: 0 0 0.5rem 0;
            font-size: 0.9rem;
            color: #495057;
        }

        .crew-tools-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .crew-tool-tag {
            background: #007bff;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .crew-job-notes {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 0.75rem;
            margin-bottom: 1rem;
        }

        .crew-job-notes h5 {
            margin: 0 0 0.5rem 0;
            font-size: 0.9rem;
            color: #856404;
        }

        .crew-job-notes p {
            margin: 0;
            font-size: 0.9rem;
            color: #856404;
            line-height: 1.4;
        }

        .crew-job-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }

        .btn-crew-action {
            padding: 0.5rem 1rem;
            border: 1px solid #dee2e6;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
        }

        .btn-crew-action:hover {
            background: #f8f9fa;
        }

        .btn-start-job:hover {
            border-color: #28a745;
            color: #28a745;
        }

        .btn-complete-job:hover {
            border-color: #007bff;
            color: #007bff;
        }

        .crew-actions {
            margin-top: 2rem;
            text-align: center;
        }

        /* Working Days Preview Styles */
        .working-days-preview {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .working-day-preview {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .working-day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #f8f9fa;
        }

        .working-day-name {
            font-weight: 600;
            color: #495057;
            font-size: 1rem;
        }

        .working-day-date {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .jobs-count-badge {
            background: #007bff;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .working-day-status {
            text-align: center;
            padding: 1rem 0;
        }

        .no-jobs-badge {
            background: #f8f9fa;
            color: #6c757d;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-style: italic;
            border: 1px dashed #dee2e6;
        }

        .working-day-jobs {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        /* Adjust crew job cards in working day preview */
        .working-day-jobs .crew-job-card {
            margin: 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        /* Mobile responsive for crew dashboard */
        @media (max-width: 600px) {
            .crew-header {
                padding: 1rem;
                margin-bottom: 1rem;
            }

            .crew-header h2 {
                font-size: 1.5rem;
            }

            .crew-tab-navigation {
                flex-direction: column;
                gap: 0.25rem;
            }

            .crew-tab-btn {
                text-align: center;
            }

            .crew-jobs-header {
                flex-direction: column;
                gap: 0.5rem;
                align-items: stretch;
            }

            .crew-job-details {
                grid-template-columns: 1fr;
            }

            .crew-job-actions {
                flex-direction: column;
            }

            .btn-crew-action {
                text-align: center;
            }

            /* Mobile responsive for working days preview */
            .working-day-header {
                flex-direction: column;
                gap: 0.5rem;
                align-items: stretch;
            }

            .working-day-name {
                text-align: center;
            }

            .working-day-date {
                text-align: center;
            }

            .jobs-count-badge {
                align-self: center;
            }
        }
        
        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid #e9ecef;
        }
        
        .modal-header h3 {
            margin: 0;
            color: #333;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6c757d;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-close:hover {
            color: #495057;
            background: #f8f9fa;
            border-radius: 50%;
        }
        
        .modal form {
            padding: 1rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        @media (max-width: 600px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            background: white;
        }
        
        select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 5px rgba(102, 126, 234, 0.3);
        }
        
        textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
        }
        
        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 5px rgba(102, 126, 234, 0.3);
        }
        
        .tools-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 0.75rem;
            background: #f8f9fa;
        }
        
        .tools-selection label {
            display: flex;
            align-items: center;
            font-weight: normal;
            margin: 0;
            cursor: pointer;
        }
        
        .tools-selection input[type="checkbox"] {
            width: auto;
            margin-right: 0.5rem;
        }
        
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid #e9ecef;
        }
        
        .modal-actions .btn {
            width: auto;
            margin: 0;
        }
        
        /* Tab Navigation Styles */
        .tab-navigation {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .tab-btn {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 0.75rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .tab-btn:hover {
            background: #e9ecef;
            border-color: #adb5bd;
        }
        
        .tab-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Calendar Styles */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .calendar-header h3 {
            margin: 0;
            color: #495057;
        }
        
        .btn-nav {
            background: #667eea;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.2s ease;
        }
        
        .btn-nav:hover {
            background: #5a6fd8;
        }
        
        .calendar-legend {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .legend-item {
            padding: 0.4rem 0.8rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
        }
        
        .legend-item.crew-a {
            background: #007bff;
        }
        
        .legend-item.crew-b {
            background: #28a745;
        }
        
        .legend-item.conflict {
            background: #dc3545;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: 80px 1fr;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            overflow: hidden;
            background: white;
        }
        
        .time-slot {
            padding: 0.75rem 0.5rem;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            font-weight: bold;
            font-size: 0.85rem;
            text-align: center;
            color: #6c757d;
        }
        
        .jobs-slot {
            padding: 0.5rem;
            border-bottom: 1px solid #dee2e6;
            min-height: 60px;
            position: relative;
        }
        
        .calendar-job {
            background: #007bff;
            color: white;
            padding: 0.4rem 0.6rem;
            border-radius: 4px;
            margin-bottom: 0.3rem;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }
        
        .calendar-job:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .calendar-job.crew-a {
            background: #007bff;
        }
        
        .calendar-job.crew-b {
            background: #28a745;
        }
        
        .calendar-job.conflict {
            background: #dc3545;
            border-color: #a02030;
            animation: pulse 2s infinite;
        }
        
        .job-time {
            font-weight: bold;
            margin-bottom: 0.2rem;
        }
        
        .job-info {
            font-size: 0.75rem;
            opacity: 0.9;
        }
        
        .admin-actions {
            margin-top: 2rem;
            text-align: center;
        }
        
        /* Mobile Calendar Adjustments */
        @media (max-width: 768px) {
            .calendar-grid {
                grid-template-columns: 60px 1fr;
            }
            
            .time-slot {
                padding: 0.5rem 0.3rem;
                font-size: 0.75rem;
            }
            
            .calendar-job {
                font-size: 0.75rem;
                padding: 0.3rem 0.4rem;
            }
            
            .job-info {
                font-size: 0.7rem;
            }
            
            .calendar-header {
                flex-direction: column;
                gap: 1rem;
            }
            
            .tab-navigation {
                justify-content: center;
            }
            
            .tab-btn {
                flex: 1;
                justify-content: center;
                min-width: 0;
            }
        }
        
        /* Documents Module Styles */
        .documents-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e9ecef;
        }

        .documents-header h3 {
            margin: 0;
            color: #333;
            font-size: 1.3rem;
        }

        .document-actions {
            display: flex;
            gap: 0.75rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .document-actions .btn {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            white-space: nowrap;
            min-width: fit-content;
        }

        /* Responsive design for smaller screens */
        @media (max-width: 768px) {
            .documents-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .document-actions {
                width: 100%;
                justify-content: space-between;
            }

            .document-actions .btn {
                flex: 1;
                text-align: center;
            }

            .crew-dashboard-content {
                padding: 0 0.5rem;
            }

            .crew-tab-btn {
                padding: 0.5rem 0.3rem;
                font-size: 0.8rem;
            }

            .crew-tab-navigation {
                gap: 0.1rem;
                padding: 0.15rem;
            }
        }

        @media (max-width: 480px) {
            .crew-tab-btn {
                padding: 0.4rem 0.2rem;
                font-size: 0.75rem;
            }

            .crew-tab-navigation {
                gap: 0.05rem;
                padding: 0.1rem;
            }
        }

        .no-documents-message {
            text-align: center;
            padding: 3rem 1rem;
            color: #6c757d;
        }

        .no-documents-message h4 {
            margin: 0 0 0.5rem 0;
            color: #495057;
            font-size: 1.2rem;
        }

        .no-documents-message p {
            margin: 0;
            font-size: 0.95rem;
        }

        .documents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .document-category {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            border: 1px solid #e9ecef;
        }

        .document-category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #dee2e6;
        }

        .document-category-header h4 {
            margin: 0;
            color: #495057;
            font-size: 1.1rem;
        }

        .document-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .document-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 1rem;
            transition: all 0.2s ease;
        }

        .document-item:hover {
            border-color: #007bff;
            box-shadow: 0 2px 8px rgba(0,123,255,0.1);
        }

        .document-item.completed {
            border-color: #28a745;
            background: linear-gradient(135deg, #f8fff9 0%, #ffffff 100%);
        }

        .document-item.overdue {
            border-color: #dc3545;
            background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%);
        }

        .document-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .document-title {
            font-weight: 600;
            color: #333;
            font-size: 1rem;
        }

        .document-status {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-completed {
            background: #d4edda;
            color: #155724;
        }

        .status-overdue {
            background: #f8d7da;
            color: #721c24;
        }

        .document-description {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 0.75rem;
            line-height: 1.4;
        }

        .document-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
            color: #6c757d;
            margin-bottom: 0.75rem;
        }

        .document-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }

        .btn-document {
            padding: 0.5rem 1rem;
            border: 1px solid #dee2e6;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .btn-document:hover {
            background: #f8f9fa;
        }

        .btn-fill-document:hover {
            border-color: #007bff;
            color: #007bff;
        }

        .btn-view-document:hover {
            border-color: #28a745;
            color: #28a745;
        }

        /* Document Form Modal Styles */
        .document-form-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .document-form-content {
            background: white;
            border-radius: 10px;
            width: 95%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .document-form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid #e9ecef;
            background: #f8f9fa;
            border-radius: 10px 10px 0 0;
        }

        .document-form-header h3 {
            margin: 0;
            color: #333;
        }

        .document-form-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6c757d;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .document-form-close:hover {
            color: #495057;
            background: #e9ecef;
            border-radius: 50%;
        }

        .document-form-body {
            padding: 1.5rem;
        }

        .form-section {
            margin-bottom: 2rem;
        }

        .form-section h4 {
            color: #495057;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e9ecef;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .form-row.full-width {
            grid-template-columns: 1fr;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: #555;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 5px rgba(102, 126, 234, 0.3);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 1rem;
            background: #f8f9fa;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
        }

        .checkbox-item label {
            margin: 0;
            font-weight: normal;
            cursor: pointer;
        }
        
        /* FLHA Specific Styles */
        .checkbox-item input[type="radio"] {
            width: auto;
            margin-right: 0.25rem;
        }
        
        .checkbox-item input[type="radio"] + label {
            margin-right: 1rem;
            font-weight: normal;
        }
        
        .form-section h5 {
            color: #495057;
            border-bottom: 2px solid #007bff;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .form-section {
            margin-bottom: 2rem;
            padding: 1rem;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            background: #ffffff;
        }

        .document-form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #e9ecef;
        }

        .document-form-actions .btn {
            width: auto;
            margin: 0;
        }

        /* Mobile responsive for documents */
        @media (max-width: 600px) {
            .documents-grid {
                grid-template-columns: 1fr;
            }
            
            .documents-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .document-category-header {
                flex-direction: column;
                gap: 0.5rem;
                align-items: stretch;
            }
            
            .document-header {
                flex-direction: column;
                gap: 0.5rem;
                align-items: stretch;
            }
            
            .document-meta {
                flex-direction: column;
                gap: 0.5rem;
                align-items: stretch;
            }
            
            .document-actions {
                justify-content: center;
            }
            
            .document-form-content {
                width: 98%;
                margin: 1%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Login Screen -->
        <div id="login-screen" class="screen active">
            <div class="company-logo-image">
                <img src="logo.png" alt="Brothers Cutting & Coring" class="logo-img">
            </div>
            <form id="login-form">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" required>
                </div>
                <button type="button" class="btn" onclick="handleLogin()">Sign In</button>
                <div id="login-error" class="error" style="display: none;"></div>
            </form>
        </div>

        <!-- Admin Dashboard -->
        <div id="admin-dashboard" class="screen">
                            <div class="company-logo">
                    <div class="logo-gradient-bar"></div>
                    <div class="logo-text">
                        <div class="logo-main-text">BROTHERS</div>
                        <div class="logo-divider"></div>
                        <div class="logo-sub-text">CUTTING & CORING LTD.</div>
                    </div>
                </div>
                <h3 style="margin-top: 1rem; color: #667eea;">Admin Dashboard</h3>
            <div class="user-info">
                <strong>Welcome, Admin!</strong><br>
                <span id="admin-stats">Loading...</span>
            </div>
            <div class="dashboard">
                <!-- Tab Navigation -->
                <div class="tab-navigation">
                    <button type="button" class="tab-btn active" onclick="switchAdminTab('list')" id="tab-list">
                        📋 Jobs List
                    </button>
                    <button type="button" class="tab-btn" onclick="switchAdminTab('calendar')" id="tab-calendar">
                        📅 Calendar View
                    </button>
                    <button type="button" class="tab-btn" onclick="switchAdminTab('equipment')" id="tab-equipment">
                        🛠️ Equipment
                    </button>
                    <button type="button" class="btn" onclick="showCreateJobModal()" style="background: #28a745; padding: 0.5rem 1rem; margin: 0;">
                        ➕ Create Job
                    </button>
                </div>

                <!-- Jobs List Tab -->
                <div id="admin-tab-list" class="tab-content active">
                    <h3>Today's Jobs</h3>
                    <div id="admin-jobs" class="job-list">
                        Loading jobs...
                    </div>
                </div>

                <!-- Calendar Tab -->
                <div id="admin-tab-calendar" class="tab-content">
                    <div class="calendar-header">
                        <button type="button" class="btn-nav" onclick="changeCalendarDate(-1)">← Previous</button>
                        <h3 id="calendar-date-title">Loading...</h3>
                        <button type="button" class="btn-nav" onclick="changeCalendarDate(1)">Next →</button>
                    </div>
                    <div class="calendar-legend">
                        <span class="legend-item crew-a">Crew A</span>
                        <span class="legend-item crew-b">Crew B</span>
                        <span class="legend-item conflict">Conflicts</span>
                    </div>
                    <div id="calendar-grid" class="calendar-grid">
                        Loading calendar...
                    </div>
                </div>

                <!-- Equipment Management Tab -->
                <div id="admin-tab-equipment" class="tab-content">
                    <div class="equipment-header">
                        <h3>Equipment Management</h3>
                        <button type="button" class="btn" onclick="showEquipmentModal()" style="background: #28a745;">
                            ➕ Add Equipment
                        </button>
                    </div>
                    <div class="equipment-categories">
                        <div class="category-section">
                            <div class="category-header">
                                <h4>🛠️ Hand Tools</h4>
                                <button type="button" class="btn-category-add" onclick="showEquipmentModal(null, 'hand-tools')">
                                    ➕ Add
                                </button>
                            </div>
                            <div id="hand-tools-list" class="equipment-list">
                                Loading...
                            </div>
                        </div>
                        <div class="category-section">
                            <div class="category-header">
                                <h4>⚡ Power Tools</h4>
                                <button type="button" class="btn-category-add" onclick="showEquipmentModal(null, 'power-tools')">
                                    ➕ Add
                                </button>
                            </div>
                            <div id="power-tools-list" class="equipment-list">
                                Loading...
                            </div>
                        </div>
                        <div class="category-section">
                            <div class="category-header">
                                <h4>🔧 Machinery</h4>
                                <button type="button" class="btn-category-add" onclick="showEquipmentModal(null, 'machinery')">
                                    ➕ Add
                                </button>
                            </div>
                            <div id="machinery-list" class="equipment-list">
                                Loading...
                            </div>
                        </div>

                    </div>
                </div>

                <div class="admin-actions">
                    <button type="button" class="btn btn-secondary" onclick="logout()">Logout</button>
                    <button type="button" class="btn btn-secondary" onclick="clearAllData()" style="background: #dc3545; margin-top: 0.5rem;">Reset All Data</button>
                </div>
            </div>
        </div>

        <!-- Crew Dashboard -->
        <div id="crew-dashboard" class="screen">
            <div class="crew-header">
                                            <div class="company-logo white-text">
                    <div class="logo-gradient-bar"></div>
                    <div class="logo-text">
                        <div class="logo-main-text">BROTHERS</div>
                        <div class="logo-divider"></div>
                        <div class="logo-sub-text">CUTTING & CORING LTD.</div>
                    </div>
                </div>
                <div class="crew-user-info">
                    <strong id="crew-name">Welcome, Crew!</strong>
                    <span id="crew-stats">Loading...</span>
                </div>
            </div>
            
            <div class="crew-dashboard-content">
                <!-- Job Status Tabs -->
                <div class="crew-tab-navigation">
                    <button type="button" class="crew-tab-btn active" onclick="switchCrewTab('today')" id="crew-tab-today">
                        📅 Today
                    </button>
                    <button type="button" class="crew-tab-btn" onclick="switchCrewTab('upcoming')" id="crew-tab-upcoming">
                        🔮 Upcoming
                    </button>
                    <button type="button" class="crew-tab-btn" onclick="switchCrewTab('documents')" id="crew-tab-documents">
                        📄 Documents
                    </button>
                </div>

                <!-- Today's Jobs Tab -->
                <div id="crew-tab-today-content" class="crew-tab-content active">
                    <div class="crew-jobs-header">
                        <h3>Today's Schedule</h3>
                        <div class="crew-time-display" id="crew-current-time">Loading...</div>
                    </div>
                    <div id="crew-jobs-today" class="crew-job-list">
                        Loading jobs...
                    </div>
                </div>

                <!-- Upcoming Jobs Tab -->
                <div id="crew-tab-upcoming-content" class="crew-tab-content">
                    <div class="crew-jobs-header">
                        <h3>Upcoming Jobs</h3>
                        <div class="crew-date-range">Next 7 days</div>
                    </div>
                    <div id="crew-jobs-upcoming" class="crew-job-list">
                        Loading jobs...
                    </div>
                </div>



                <!-- Documents Tab -->
                <div id="crew-tab-documents-content" class="crew-tab-content">
                    <div class="documents-header">
                        <h3>📄 Document Management</h3>
                    </div>
                    <div id="crew-documents" class="documents-grid">
                        <div class="no-documents-message">
                            <h4>No documents assigned</h4>
                            <p>You don't have any documents to fill out at this time.</p>
                            <button type="button" class="btn" onclick="showDocumentFormModal()">📝 Create New Document</button>
                        </div>
                    </div>
                </div>

                <div class="crew-actions">
                    <button type="button" class="btn btn-secondary" onclick="logout()">Logout</button>
                </div>
            </div>
        </div>

        <!-- Job Creation Modal -->
        <div id="create-job-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Create New Job</h3>
                    <button type="button" class="modal-close" onclick="hideCreateJobModal()">&times;</button>
                </div>
                <form id="create-job-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="job-date">Date</label>
                            <input type="date" id="job-date" required>
                        </div>
                        <div class="form-group">
                            <label for="job-start-time">Start Time</label>
                            <input type="time" id="job-start-time" required>
                        </div>
                        <div class="form-group">
                            <label for="job-end-time">End Time</label>
                            <input type="time" id="job-end-time" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="job-address">Address</label>
                        <input type="text" id="job-address" placeholder="123 Main St, City, State ZIP" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="job-crew">Crew</label>
                            <select id="job-crew" required>
                                <option value="">Select Crew</option>
                                <option value="A">Crew A</option>
                                <option value="B">Crew B</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="job-vehicle">Vehicle</label>
                            <select id="job-vehicle" required>
                                <option value="">Select Vehicle</option>
                                <option value="F250">F250</option>
                                <option value="Savannah">Savannah</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="job-site-contact">Site Contact</label>
                            <input type="text" id="job-site-contact" placeholder="Contact name and phone number" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="job-tools">Tools Needed</label>
                        <div id="job-tools" class="tools-selection">
                            <!-- Equipment list will be populated dynamically -->
                            <p style="color: #6c757d; font-style: italic;">Loading equipment...</p>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="job-notes">Notes</label>
                        <textarea id="job-notes" rows="3" placeholder="Special instructions, customer preferences, etc."></textarea>
                    </div>
                    
                    <div id="job-conflict-warning" class="error" style="display: none;"></div>
                    
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" onclick="hideCreateJobModal()">Cancel</button>
                        <button type="button" class="btn" onclick="createJob()">Create Job</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Equipment Management Modal -->
        <div id="equipment-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="equipment-modal-title">Add Equipment</h3>
                    <button type="button" class="modal-close" onclick="hideEquipmentModal()">&times;</button>
                </div>
                <form id="equipment-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="equipment-name">Equipment Name</label>
                            <input type="text" id="equipment-name" required placeholder="e.g., Cordless Drill">
                        </div>
                        <div class="form-group">
                            <label for="equipment-category">Category</label>
                            <select id="equipment-category" required>
                                <option value="">Select Category</option>
                                <option value="hand-tools">🛠️ Hand Tools</option>
                                <option value="power-tools">⚡ Power Tools</option>
                                <option value="machinery">🔧 Machinery</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="equipment-description">Description (Optional)</label>
                        <textarea id="equipment-description" rows="2" placeholder="Brief description of the equipment"></textarea>
                    </div>
                    
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" onclick="hideEquipmentModal()">Cancel</button>
                        <button type="button" class="btn" onclick="saveEquipment()">Save Equipment</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Document Form Modal -->
        <div id="document-form-modal" class="document-form-modal" style="display: none;">
            <div class="document-form-content">
                <div class="document-form-header">
                    <h3 id="document-form-title">Fill Out Document</h3>
                    <button type="button" class="document-form-close" onclick="hideDocumentFormModal()">&times;</button>
                </div>
                <div class="document-form-body">
                    <form id="document-form">
                        <!-- Document Type Selection -->
                        <div class="form-section">
                            <h4>📋 Document Information</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="document-type">Document Type</label>
                                    <select id="document-type" required onchange="loadDocumentTemplate()">
                                        <option value="">Select Document Type</option>
                                        <option value="flha">FLHA - Field Level Hazard Assessment</option>
                                        <option value="daily-job-record">Daily Job Record (DJR)</option>
                                        <option value="safe-work-procedure">Safe Work Procedure (SWP)</option>
                                        <option value="silica-exposure-plan">Silica Exposure Plan</option>
                                        <option value="safety-checklist">Safety Checklist</option>
                                        <option value="work-order">Work Order Form</option>
                                        <option value="incident-report">Incident Report</option>
                                        <option value="equipment-inspection">Equipment Inspection</option>
                                        <option value="time-sheet">Time Sheet</option>
                                        <option value="material-request">Material Request</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Dynamic Document Content -->
                        <div id="document-content">
                            <div class="form-section">
                                <h4>📝 Document Content</h4>
                                <p style="color: #6c757d; font-style: italic;">Select a document type to load the template.</p>
                            </div>
                        </div>

                        <div class="document-form-actions">
                            <button type="button" class="btn btn-secondary" onclick="hideDocumentFormModal()">Cancel</button>
                            <button type="button" class="btn" onclick="saveDocument()">Save Document</button>
                            <button type="button" class="btn btn-success" onclick="exportDocumentToPDF()">Export to PDF</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Storage keys for localStorage
        const STORAGE_KEYS = {
            USERS: 'schedule_users',
            JOBS: 'schedule_jobs',
            EQUIPMENT: 'schedule_equipment',
            DOCUMENTS: 'schedule_documents',
            CURRENT_USER: 'schedule_current_user'
        };

        // Default data (used only if localStorage is empty)
        const DEFAULT_DATA = {
            users: [
                { id: 1, username: 'admin', password: 'admin123', role: 'admin', crewName: null },
                { id: 2, username: 'crew_a', password: 'crewa123', role: 'crew', crewName: 'A' },
                { id: 3, username: 'crew_b', password: 'crewb123', role: 'crew', crewName: 'B' }
            ],
            jobs: [
                {
                    id: 1,
                    date: new Date().toISOString().split('T')[0],
                    startTime: '08:00',
                    endTime: '12:00',
                    address: '123 Main St, Anytown, ST 12345',
                    crew: 'A',
                    vehicle: 'F250',
                    siteContact: 'John Smith - (555) 123-4567',
                    tools: ['Cordless Drill', 'Ladder'],
                    notes: 'Morning installation job'
                },
                {
                    id: 2,
                    date: new Date().toISOString().split('T')[0],
                    startTime: '14:00',
                    endTime: '17:00',
                    address: '456 Oak Ave, Anytown, ST 12345',
                    crew: 'B',
                    vehicle: 'Savannah',
                    siteContact: 'Sarah Johnson - (555) 987-6543',
                    tools: ['Circular Saw', 'Hammer'],
                    notes: 'Afternoon repair work'
                },
                {
                    id: 3,
                    date: new Date().toISOString().split('T')[0],
                    startTime: '09:00',
                    endTime: '13:00',
                    address: '789 Pine Rd, Anytown, ST 12345',
                    crew: 'A',
                    vehicle: 'F250',
                    siteContact: 'Mike Wilson - (555) 456-7890',
                    tools: ['Cordless Drill', 'Circular Saw'],
                    notes: 'Large installation'
                },
                {
                    id: 4,
                    date: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    startTime: '10:00',
                    endTime: '15:00',
                    address: '321 Elm St, Anytown, ST 12345',
                    crew: 'A',
                    vehicle: 'Savannah',
                    siteContact: 'Lisa Brown - (555) 321-6547',
                    tools: ['Measuring Tape', 'Level'],
                    notes: 'Site survey and measurements'
                },
                {
                    id: 5,
                    date: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    startTime: '08:00',
                    endTime: '16:00',
                    address: '654 Maple Dr, Anytown, ST 12345',
                    crew: 'B',
                    vehicle: 'F250',
                    siteContact: 'David Lee - (555) 789-0123',
                    tools: ['Generator', 'Air Compressor'],
                    notes: 'Heavy equipment installation - completed successfully'
                },
                {
                    id: 6,
                    date: new Date(Date.now() + 3 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    startTime: '09:00',
                    endTime: '14:00',
                    address: '987 Cedar Ln, Anytown, ST 12345',
                    crew: 'A',
                    vehicle: 'F250',
                    siteContact: 'Jennifer Davis - (555) 234-5678',
                    tools: ['Cordless Drill', 'Measuring Tape'],
                    notes: 'Kitchen cabinet installation'
                },
                {
                    id: 7,
                    date: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    startTime: '07:00',
                    endTime: '18:00',
                    address: '555 Birch Ave, Anytown, ST 12345',
                    crew: 'B',
                    vehicle: 'Savannah',
                    siteContact: 'Robert Taylor - (555) 345-6789',
                    tools: ['Circular Saw', 'Hammer', 'Level'],
                    notes: 'Full day renovation project - bring extra materials'
                }
            ],
            equipment: [
                { id: 1, name: 'Cordless Drill', category: 'power-tools', description: '18V lithium-ion drill with charger' },
                { id: 2, name: 'Circular Saw', category: 'power-tools', description: '7-1/4 inch blade, corded' },
                { id: 3, name: 'Hammer', category: 'hand-tools', description: '16oz claw hammer' },
                { id: 4, name: 'Screwdriver Set', category: 'hand-tools', description: 'Phillips and flathead set' },
                { id: 5, name: 'Measuring Tape', category: 'hand-tools', description: '25-foot retractable tape' },
                { id: 6, name: 'Level', category: 'hand-tools', description: '24-inch bubble level' },
                { id: 7, name: 'Generator', category: 'machinery', description: '5000W portable generator' },
                { id: 8, name: 'Air Compressor', category: 'machinery', description: '20-gallon tank, 150 PSI' }
            ],
            documents: []
        };

        // localStorage utility functions
        function loadFromStorage(key, defaultValue = []) {
            try {
                const stored = localStorage.getItem(key);
                return stored ? JSON.parse(stored) : defaultValue;
            } catch (error) {
                console.error(`Error loading ${key} from localStorage:`, error);
                return defaultValue;
            }
        }

        function saveToStorage(key, data) {
            try {
                localStorage.setItem(key, JSON.stringify(data));
                return true;
            } catch (error) {
                console.error(`Error saving ${key} to localStorage:`, error);
                return false;
            }
        }

        // Initialize data from localStorage or use defaults
        function initializeAppData() {
            const users = loadFromStorage(STORAGE_KEYS.USERS, DEFAULT_DATA.users);
            const jobs = loadFromStorage(STORAGE_KEYS.JOBS, DEFAULT_DATA.jobs);
            const equipment = loadFromStorage(STORAGE_KEYS.EQUIPMENT, DEFAULT_DATA.equipment);
            const documents = loadFromStorage(STORAGE_KEYS.DOCUMENTS, DEFAULT_DATA.documents);
            const currentUser = loadFromStorage(STORAGE_KEYS.CURRENT_USER, null);

            // If localStorage is empty, save default data
            if (!localStorage.getItem(STORAGE_KEYS.USERS)) {
                saveToStorage(STORAGE_KEYS.USERS, DEFAULT_DATA.users);
                console.log('✅ Default users saved to localStorage');
            }
            
            if (!localStorage.getItem(STORAGE_KEYS.JOBS)) {
                saveToStorage(STORAGE_KEYS.JOBS, DEFAULT_DATA.jobs);
                console.log('✅ Default jobs saved to localStorage');
            }

            if (!localStorage.getItem(STORAGE_KEYS.EQUIPMENT)) {
                saveToStorage(STORAGE_KEYS.EQUIPMENT, DEFAULT_DATA.equipment);
                console.log('✅ Default equipment saved to localStorage');
            }

            if (!localStorage.getItem(STORAGE_KEYS.DOCUMENTS)) {
                saveToStorage(STORAGE_KEYS.DOCUMENTS, DEFAULT_DATA.documents);
                console.log('✅ Default documents saved to localStorage');
            }

            return { users, jobs, equipment, documents, currentUser };
        }

        // Persistent data store with localStorage
        const AppData = initializeAppData();
        
        // Clear existing documents from localStorage to start fresh
        localStorage.removeItem(STORAGE_KEYS.DOCUMENTS);
        AppData.documents = [];
        console.log('🗑️ Documents cleared from localStorage');

        // Functions to update and persist data
        function addJob(job) {
            // Generate new ID
            const maxId = AppData.jobs.length > 0 ? Math.max(...AppData.jobs.map(j => j.id)) : 0;
            job.id = maxId + 1;
            
            AppData.jobs.push(job);
            saveToStorage(STORAGE_KEYS.JOBS, AppData.jobs);
            console.log('✅ Job added and saved to localStorage');
        }

        function updateJob(jobId, updates) {
            const index = AppData.jobs.findIndex(job => job.id === jobId);
            if (index !== -1) {
                AppData.jobs[index] = { ...AppData.jobs[index], ...updates };
                saveToStorage(STORAGE_KEYS.JOBS, AppData.jobs);
                console.log('✅ Job updated and saved to localStorage');
                return true;
            }
            return false;
        }

        function deleteJob(jobId) {
            AppData.jobs = AppData.jobs.filter(job => job.id !== jobId);
            saveToStorage(STORAGE_KEYS.JOBS, AppData.jobs);
            console.log('✅ Job deleted and saved to localStorage');
        }

        function setCurrentUser(user) {
            AppData.currentUser = user;
            saveToStorage(STORAGE_KEYS.CURRENT_USER, user);
            console.log('✅ Current user saved to localStorage');
        }

        function clearCurrentUser() {
            AppData.currentUser = null;
            localStorage.removeItem(STORAGE_KEYS.CURRENT_USER);
            console.log('✅ User session cleared from localStorage');
        }

        function clearAllData() {
            if (confirm('⚠️ This will delete ALL jobs and reset to default data. Are you sure?')) {
                // Clear localStorage
                Object.values(STORAGE_KEYS).forEach(key => {
                    localStorage.removeItem(key);
                });
                
                // Reset AppData to defaults
                AppData.users = [...DEFAULT_DATA.users];
                AppData.jobs = [...DEFAULT_DATA.jobs];
                AppData.equipment = [...DEFAULT_DATA.equipment];
                AppData.currentUser = null;
                
                // Save defaults back to localStorage
                saveToStorage(STORAGE_KEYS.USERS, DEFAULT_DATA.users);
                saveToStorage(STORAGE_KEYS.JOBS, DEFAULT_DATA.jobs);
                saveToStorage(STORAGE_KEYS.EQUIPMENT, DEFAULT_DATA.equipment);
                
                console.log('🗑️ All data cleared and reset to defaults');
                alert('✅ Data reset complete! You will be logged out.');
                
                // Logout and return to login screen
                logout();
            }
        }

        // Global variables
        let editingJobId = null;
        let currentCalendarDate = new Date();

        // Job Creation Functions
        function showCreateJobModal() {
            editingJobId = null; // Reset edit mode
            
            // Update modal title
            document.querySelector('#create-job-modal .modal-header h3').textContent = 'Create New Job';
            document.querySelector('#create-job-modal .btn:last-child').textContent = 'Create Job';
            
            // Update tools list from equipment
            updateJobToolsList();
            
            // Set default date to today
            document.getElementById('job-date').value = new Date().toISOString().split('T')[0];
            
            // Clear form
            document.getElementById('create-job-form').reset();
            document.getElementById('job-date').value = new Date().toISOString().split('T')[0];
            
            // Clear any previous warnings
            document.getElementById('job-conflict-warning').style.display = 'none';
            
            // Show modal
            document.getElementById('create-job-modal').style.display = 'flex';
        }

        function hideCreateJobModal() {
            document.getElementById('create-job-modal').style.display = 'none';
            editingJobId = null; // Reset edit mode when closing
        }

        // Document Management Functions
        function showDocumentFormModal() {
            // Clear any previous form data
            document.getElementById('document-type').value = '';
            document.getElementById('document-content').innerHTML = `
                <div class="form-section">
                    <h4>📝 Document Content</h4>
                    <p style="color: #6c757d; font-style: italic;">Select a document type to load the template.</p>
                </div>
            `;
            
            // Show the document form modal
            document.getElementById('document-form-modal').style.display = 'flex';
        }



        function editJob(jobId) {
            const job = AppData.jobs.find(j => j.id === jobId);
            if (!job) {
                alert('❌ Job not found!');
                return;
            }
            
            // Set edit mode
            editingJobId = jobId;
            
            // Update modal title
            document.querySelector('#create-job-modal .modal-header h3').textContent = `Edit Job #${jobId}`;
            document.querySelector('#create-job-modal .btn:last-child').textContent = 'Update Job';
            
            // Update tools list from equipment
            updateJobToolsList();
            
            // Pre-fill form with job data
            document.getElementById('job-date').value = job.date;
            document.getElementById('job-start-time').value = job.startTime;
            document.getElementById('job-end-time').value = job.endTime;
            document.getElementById('job-address').value = job.address;
            document.getElementById('job-crew').value = job.crew;
            document.getElementById('job-vehicle').value = job.vehicle;
            document.getElementById('job-site-contact').value = job.siteContact || '';
            document.getElementById('job-notes').value = job.notes;
            
            // Pre-select tools (after updating the list)
            setTimeout(() => {
                const toolCheckboxes = document.querySelectorAll('#job-tools input[type="checkbox"]');
                toolCheckboxes.forEach(cb => {
                    cb.checked = job.tools.includes(cb.value);
                });
            }, 100);
            
            // Clear any previous warnings
            document.getElementById('job-conflict-warning').style.display = 'none';
            
            // Show modal
            document.getElementById('create-job-modal').style.display = 'flex';
            
            console.log('✏️ Editing job:', job);
        }

        function deleteJobConfirm(jobId) {
            const job = AppData.jobs.find(j => j.id === jobId);
            if (!job) {
                alert('❌ Job not found!');
                return;
            }
            
            const confirmMessage = `⚠️ Are you sure you want to delete this job?\n\nJob #${jobId}\nDate: ${job.date}\nTime: ${job.startTime} - ${job.endTime}\nCrew: ${job.crew}\nAddress: ${job.address}\n\nThis action cannot be undone!`;
            
            if (confirm(confirmMessage)) {
                // Delete the job
                deleteJob(jobId);
                
                // Reload admin dashboard
                refreshAdminView();
                
                // Show success message
                alert(`✅ Job #${jobId} deleted successfully!`);
                
                console.log(`🗑️ Job #${jobId} deleted`);
            }
        }

        function checkJobConflicts(newJob) {
            const conflicts = [];
            
            for (const job of AppData.jobs) {
                // Skip if different date
                if (job.date !== newJob.date) continue;
                
                // Check if same crew AND vehicle AND overlapping time
                if (job.crew === newJob.crew && 
                    job.vehicle === newJob.vehicle &&
                    doTimesOverlap(job.startTime, job.endTime, newJob.startTime, newJob.endTime)) {
                    
                    conflicts.push({
                        jobId: job.id,
                        message: `Crew ${job.crew} with ${job.vehicle} already scheduled ${job.startTime}-${job.endTime} at ${job.address}`
                    });
                }
            }
            
            return conflicts;
        }

        function checkJobConflictsExcluding(newJob, excludeJobId) {
            const conflicts = [];
            
            for (const job of AppData.jobs) {
                // Skip the job being edited
                if (job.id === excludeJobId) continue;
                
                // Skip if different date
                if (job.date !== newJob.date) continue;
                
                // Check if same crew AND vehicle AND overlapping time
                if (job.crew === newJob.crew && 
                    job.vehicle === newJob.vehicle &&
                    doTimesOverlap(job.startTime, job.endTime, newJob.startTime, newJob.endTime)) {
                    
                    conflicts.push({
                        jobId: job.id,
                        message: `Crew ${job.crew} with ${job.vehicle} already scheduled ${job.startTime}-${job.endTime} at ${job.address}`
                    });
                }
            }
            
            return conflicts;
        }

        function doTimesOverlap(start1, end1, start2, end2) {
            // Convert time strings to minutes for comparison
            const toMinutes = (timeStr) => {
                const [hours, minutes] = timeStr.split(':').map(Number);
                return hours * 60 + minutes;
            };
            
            const start1Min = toMinutes(start1);
            const end1Min = toMinutes(end1);
            const start2Min = toMinutes(start2);
            const end2Min = toMinutes(end2);
            
            // Check if ranges overlap
            return start1Min < end2Min && start2Min < end1Min;
        }

        function createJob() {
            // Get form data
            const form = document.getElementById('create-job-form');
            const formData = new FormData(form);
            
            // Get values
            const date = document.getElementById('job-date').value;
            const startTime = document.getElementById('job-start-time').value;
            const endTime = document.getElementById('job-end-time').value;
            const address = document.getElementById('job-address').value.trim();
            const crew = document.getElementById('job-crew').value;
            const vehicle = document.getElementById('job-vehicle').value;
            const siteContact = document.getElementById('job-site-contact').value.trim();
            const notes = document.getElementById('job-notes').value.trim();
            
            // Get selected tools
            const toolCheckboxes = document.querySelectorAll('#job-tools input[type="checkbox"]:checked');
            const tools = Array.from(toolCheckboxes).map(cb => cb.value);
            
            // Validation
            if (!date || !startTime || !endTime || !address || !crew || !vehicle || !siteContact) {
                alert('❌ Please fill in all required fields!');
                return;
            }
            
            if (startTime >= endTime) {
                alert('❌ End time must be after start time!');
                return;
            }
            
            if (tools.length === 0) {
                if (!confirm('⚠️ No tools selected. Continue without tools?')) {
                    return;
                }
            }
            
            // Create job object
            const newJob = {
                date,
                startTime,
                endTime,
                address,
                crew,
                vehicle,
                siteContact,
                tools,
                notes: notes || 'No additional notes'
            };
            
            // Check for conflicts (excluding current job if editing)
            const conflicts = editingJobId ? 
                checkJobConflictsExcluding(newJob, editingJobId) : 
                checkJobConflicts(newJob);
                
            const conflictWarning = document.getElementById('job-conflict-warning');
            
            if (conflicts.length > 0) {
                const conflictText = conflicts.map(c => c.message).join('\n');
                conflictWarning.textContent = `⚠️ CONFLICT DETECTED: ${conflictText}`;
                conflictWarning.style.display = 'block';
                
                const action = editingJobId ? 'update' : 'create';
                if (!confirm(`⚠️ SCHEDULING CONFLICT DETECTED:\n\n${conflictText}\n\nDo you want to ${action} this job anyway?`)) {
                    return;
                }
            }
            
            // Create or update job
            if (editingJobId) {
                // Update existing job
                updateJob(editingJobId, newJob);
                alert(`✅ Job #${editingJobId} updated successfully!`);
                console.log('✅ Job updated:', newJob);
            } else {
                // Add new job
                addJob(newJob);
                alert('✅ Job created successfully!');
                console.log('✅ New job created:', newJob);
            }
            
            // Close modal
            hideCreateJobModal();
            
            // Reload admin dashboard
            refreshAdminView();
        }

        // Tab Management Functions
        function switchAdminTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`tab-${tabName}`).classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`admin-tab-${tabName}`).classList.add('active');
            
            // Load specific content based on tab
            if (tabName === 'calendar') {
                loadCalendar();
            } else if (tabName === 'equipment') {
                loadEquipmentTab();
            }
            
            console.log(`📋 Switched to ${tabName} tab`);
        }

        // Calendar Functions
        function loadCalendar() {
            const dateStr = currentCalendarDate.toISOString().split('T')[0];
            const formattedDate = formatDisplayDate(dateStr);
            
            // Update calendar title
            document.getElementById('calendar-date-title').textContent = formattedDate;
            
            // Get jobs for current date
            const dayJobs = AppData.jobs.filter(job => job.date === dateStr);
            
            // Generate calendar grid
            generateCalendarGrid(dayJobs);
            
            console.log(`📅 Calendar loaded for ${dateStr} with ${dayJobs.length} jobs`);
        }

        function changeCalendarDate(direction) {
            // direction: -1 for previous day, +1 for next day
            currentCalendarDate.setDate(currentCalendarDate.getDate() + direction);
            loadCalendar();
        }

        function generateCalendarGrid(jobs) {
            const grid = document.getElementById('calendar-grid');
            
            // Define time slots (6 AM to 8 PM in 1-hour increments)
            const timeSlots = [];
            for (let hour = 6; hour <= 20; hour++) {
                timeSlots.push({
                    time: `${hour.toString().padStart(2, '0')}:00`,
                    display: hour <= 12 ? `${hour}:00 AM` : `${hour - 12}:00 PM`
                });
            }
            
            // Special case for 12 PM
            timeSlots[6].display = '12:00 PM';
            
            let gridHTML = '';
            
            timeSlots.forEach(slot => {
                // Time slot header
                gridHTML += `<div class="time-slot">${slot.display}</div>`;
                
                // Jobs for this time slot
                const slotJobs = getJobsForTimeSlot(jobs, slot.time);
                
                gridHTML += `<div class="jobs-slot">`;
                slotJobs.forEach(job => {
                    // Check if job has conflicts
                    const conflicts = checkJobConflictsExcluding(job, job.id);
                    const hasConflict = conflicts.length > 0;
                    
                    const crewClass = `crew-${job.crew.toLowerCase()}`;
                    const conflictClass = hasConflict ? ' conflict' : '';
                    
                    gridHTML += `
                        <div class="calendar-job ${crewClass}${conflictClass}" onclick="editJob(${job.id})" title="Click to edit job">
                            <div class="job-time">${job.startTime} - ${job.endTime}</div>
                            <div class="job-info">
                                Crew ${job.crew} • ${job.vehicle}<br>
                                ${truncateText(job.address, 30)}<br>
                                📞 ${truncateText(job.siteContact || 'No contact', 20)}
                                ${hasConflict ? '<br>⚠️ CONFLICT' : ''}
                            </div>
                        </div>
                    `;
                });
                gridHTML += `</div>`;
            });
            
            grid.innerHTML = gridHTML;
        }

        function getJobsForTimeSlot(jobs, slotTime) {
            const slotHour = parseInt(slotTime.split(':')[0]);
            
            return jobs.filter(job => {
                const startHour = parseInt(job.startTime.split(':')[0]);
                const endHour = parseInt(job.endTime.split(':')[0]);
                const endMinutes = parseInt(job.endTime.split(':')[1]);
                
                // Job appears in slot if it starts in this hour OR overlaps with this hour
                return (startHour === slotHour) || 
                       (startHour < slotHour && (endHour > slotHour || (endHour === slotHour && endMinutes > 0)));
            });
        }

        function formatDisplayDate(dateStr) {
            const date = new Date(dateStr + 'T00:00:00');
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            
            // Check if it's today, tomorrow, or yesterday
            if (date.toDateString() === today.toDateString()) {
                return `Today - ${date.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })}`;
            } else if (date.toDateString() === tomorrow.toDateString()) {
                return `Tomorrow - ${date.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })}`;
            } else if (date.toDateString() === yesterday.toDateString()) {
                return `Yesterday - ${date.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })}`;
            } else {
                return date.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' });
            }
        }

        // Update loadAdminDashboard to refresh calendar if active
        function refreshAdminView() {
            loadAdminDashboard();
            
            // If calendar tab is active, refresh calendar too
            const calendarTab = document.getElementById('admin-tab-calendar');
            if (calendarTab && calendarTab.classList.contains('active')) {
                loadCalendar();
            }
            
            // If equipment tab is active, refresh equipment too
            const equipmentTab = document.getElementById('admin-tab-equipment');
            if (equipmentTab && equipmentTab.classList.contains('active')) {
                loadEquipmentTab();
            }
        }

        // Equipment Management Functions
        function loadEquipmentTab() {
            console.log('🛠️ Loading equipment tab...');
            const equipment = AppData.equipment || [];
            
            // Group equipment by category
            const categories = {
                'hand-tools': equipment.filter(e => e.category === 'hand-tools'),
                'power-tools': equipment.filter(e => e.category === 'power-tools'),
                'machinery': equipment.filter(e => e.category === 'machinery')
            };
            
            // Update each category list
            Object.keys(categories).forEach(category => {
                const listId = `${category.replace('-', '-')}-list`;
                const listElement = document.getElementById(listId);
                if (listElement) {
                    const items = categories[category];
                    if (items.length === 0) {
                        listElement.innerHTML = '<p style="color: #6c757d; font-style: italic;">No equipment in this category</p>';
                    } else {
                        listElement.innerHTML = items.map(item => `
                            <div class="equipment-item">
                                <div class="equipment-info">
                                    <div class="equipment-name">${item.name}</div>
                                    ${item.description ? `<p class="equipment-description">${item.description}</p>` : ''}
                                </div>
                                <div class="equipment-actions">
                                    <button type="button" class="btn-equipment btn-edit-equipment" onclick="editEquipment(${item.id})">
                                        ✏️ Edit
                                    </button>
                                    <button type="button" class="btn-equipment btn-delete-equipment" onclick="deleteEquipmentConfirm(${item.id})">
                                        🗑️ Delete
                                    </button>
                                </div>
                            </div>
                        `).join('');
                    }
                }
            });
            
            console.log(`🛠️ Equipment tab loaded with ${equipment.length} items`);
        }

        function showEquipmentModal(equipmentId = null, category = null) {
            const modal = document.getElementById('equipment-modal');
            const title = document.getElementById('equipment-modal-title');
            const form = document.getElementById('equipment-form');
            
            // Clear form
            form.reset();
            
            if (equipmentId) {
                // Editing existing equipment
                const equipment = AppData.equipment.find(e => e.id === equipmentId);
                if (equipment) {
                    title.textContent = 'Edit Equipment';
                    document.getElementById('equipment-name').value = equipment.name;
                    document.getElementById('equipment-category').value = equipment.category;
                    document.getElementById('equipment-description').value = equipment.description || '';
                    form.dataset.editingId = equipmentId;
                }
            } else {
                // Adding new equipment
                const categoryNames = {
                    'hand-tools': 'Hand Tools',
                    'power-tools': 'Power Tools',
                    'machinery': 'Machinery'
                };
                
                if (category && categoryNames[category]) {
                    title.textContent = `Add ${categoryNames[category]}`;
                } else {
                    title.textContent = 'Add Equipment';
                }
                
                delete form.dataset.editingId;
                
                // Auto-select category if provided
                if (category) {
                    document.getElementById('equipment-category').value = category;
                }
            }
            
            modal.style.display = 'flex';
        }

        function hideEquipmentModal() {
            document.getElementById('equipment-modal').style.display = 'none';
        }

        function saveEquipment() {
            const name = document.getElementById('equipment-name').value.trim();
            const category = document.getElementById('equipment-category').value;
            const description = document.getElementById('equipment-description').value.trim();
            const form = document.getElementById('equipment-form');
            const editingId = form.dataset.editingId;
            
            if (!name || !category) {
                alert('Please fill in all required fields');
                return;
            }
            
            if (editingId) {
                // Update existing equipment
                const equipmentIndex = AppData.equipment.findIndex(e => e.id === parseInt(editingId));
                if (equipmentIndex !== -1) {
                    AppData.equipment[equipmentIndex] = {
                        ...AppData.equipment[equipmentIndex],
                        name,
                        category,
                        description
                    };
                    saveToStorage(STORAGE_KEYS.EQUIPMENT, AppData.equipment);
                    console.log(`🛠️ Updated equipment: ${name}`);
                }
            } else {
                // Add new equipment
                const newId = Math.max(...AppData.equipment.map(e => e.id), 0) + 1;
                const newEquipment = {
                    id: newId,
                    name,
                    category,
                    description
                };
                AppData.equipment.push(newEquipment);
                saveToStorage(STORAGE_KEYS.EQUIPMENT, AppData.equipment);
                console.log(`🛠️ Added new equipment: ${name}`);
            }
            
            hideEquipmentModal();
            loadEquipmentTab();
            updateJobToolsList(); // Update job creation form tools list
        }

        function editEquipment(equipmentId) {
            showEquipmentModal(equipmentId);
        }

        function deleteEquipmentConfirm(equipmentId) {
            const equipment = AppData.equipment.find(e => e.id === equipmentId);
            if (!equipment) return;
            
            if (confirm(`Are you sure you want to delete "${equipment.name}"?`)) {
                deleteEquipment(equipmentId);
            }
        }

        function deleteEquipment(equipmentId) {
            const equipmentIndex = AppData.equipment.findIndex(e => e.id === equipmentId);
            if (equipmentIndex !== -1) {
                const deletedEquipment = AppData.equipment[equipmentIndex];
                AppData.equipment.splice(equipmentIndex, 1);
                saveToStorage(STORAGE_KEYS.EQUIPMENT, AppData.equipment);
                console.log(`🛠️ Deleted equipment: ${deletedEquipment.name}`);
                
                loadEquipmentTab();
                updateJobToolsList(); // Update job creation form tools list
            }
        }

        function updateJobToolsList() {
            // Update the tools checkboxes in job creation form
            const toolsContainer = document.getElementById('job-tools');
            if (toolsContainer) {
                const equipment = AppData.equipment || [];
                toolsContainer.innerHTML = equipment.map(item => 
                    `<label><input type="checkbox" value="${item.name}"> ${item.name}</label>`
                ).join('');
            }
        }

        // Utility functions
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function showError(message) {
            const errorDiv = document.getElementById('login-error');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        function hideError() {
            const errorDiv = document.getElementById('login-error');
            errorDiv.style.display = 'none';
        }

        function truncateText(text, maxLength = 50) {
            if (!text) return '';
            if (text.length <= maxLength) return text;
            return text.substring(0, maxLength) + '...';
        }

        // Authentication functions
        function handleLogin() {
            console.log('🔐 Login attempt started');
            hideError();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            
            if (!username || !password) {
                showError('Please enter both username and password');
                return;
            }
            
            // Find user
            const user = AppData.users.find(u => u.username === username && u.password === password);
            
            if (user) {
                setCurrentUser(user);
                console.log('✅ Login successful:', user.role);
                
                if (user.role === 'admin') {
                    loadAdminDashboard();
                    showScreen('admin-dashboard');
                } else {
                    loadCrewDashboard();
                    showScreen('crew-dashboard');
                }
            } else {
                console.log('❌ Login failed');
                showError('Invalid username or password');
            }
        }

        function logout() {
            clearCurrentUser();
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            hideError();
            showScreen('login-screen');
        }

        // Dashboard functions
        function loadAdminDashboard() {
            const todaysJobs = AppData.jobs.filter(job => job.date === new Date().toISOString().split('T')[0]);
            
            // Update stats
            document.getElementById('admin-stats').textContent = 
                `Total Jobs Today: ${todaysJobs.length} | Total Users: ${AppData.users.length}`;
            
            // Load jobs
            const jobsContainer = document.getElementById('admin-jobs');
            if (todaysJobs.length === 0) {
                jobsContainer.innerHTML = '<p>No jobs scheduled for today.</p>';
            } else {
                jobsContainer.innerHTML = todaysJobs.map(job => {
                    // Check if this job has conflicts (excluding itself)
                    const conflicts = checkJobConflictsExcluding(job, job.id);
                    const hasConflict = conflicts.length > 0;
                    
                    return `
                    <div class="job-card ${hasConflict ? 'job-conflict' : ''}">
                        <div class="job-header">
                            <h4>Job #${job.id} - Crew ${job.crew}</h4>
                            ${hasConflict ? '<span class="conflict-flag">⚠️ CONFLICT</span>' : ''}
                        </div>
                        <div class="job-details">
                            <strong>Time:</strong> ${job.startTime} - ${job.endTime}<br>
                            <strong>Address:</strong> ${job.address}<br>
                            <strong>Vehicle:</strong> ${job.vehicle}<br>
                            <strong>Site Contact:</strong> ${job.siteContact || 'Not specified'}<br>
                            <strong>Tools:</strong> ${job.tools.join(', ')}<br>
                            <strong>Notes:</strong> ${job.notes}
                            ${hasConflict ? `<br><strong class="conflict-details">Conflicts:</strong> ${conflicts.map(c => c.message).join('; ')}` : ''}
                        </div>
                        <div class="job-actions">
                            <button type="button" class="btn-action btn-edit" onclick="editJob(${job.id})" title="Edit Job">
                                ✏️ Edit
                            </button>
                            <button type="button" class="btn-action btn-delete" onclick="deleteJobConfirm(${job.id})" title="Delete Job">
                                🗑️ Delete
                            </button>
                        </div>
                    </div>
                `;
                }).join('');
            }
        }

        function loadCrewDashboard() {
            const user = AppData.currentUser;
            
            // Update crew name and stats
            document.getElementById('crew-name').textContent = `Welcome, Crew ${user.crewName}!`;
            
            // Update current time
            updateCrewCurrentTime();
            
            // Load all tabs
            loadCrewTodayTab();
            loadCrewUpcomingTab();
            loadCrewDocumentsTab();
            
            console.log(`👷 Crew dashboard loaded for ${user.crewName}`);
        }

        function updateCrewCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: true 
            });
            document.getElementById('crew-current-time').textContent = timeString;
            
            // Update time every minute
            setTimeout(updateCrewCurrentTime, 60000);
        }

        function switchCrewTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.crew-tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`crew-tab-${tabName}`).classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.crew-tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`crew-tab-${tabName}-content`).classList.add('active');
            
            console.log(`👷 Switched to ${tabName} tab`);
        }

        function loadCrewTodayTab() {
            const user = AppData.currentUser;
            const today = new Date().toISOString().split('T')[0];
            const crewJobs = AppData.jobs.filter(job => 
                job.crew === user.crewName && 
                job.date === today
            );
            
            // Update stats
            document.getElementById('crew-stats').textContent = `Your Jobs Today: ${crewJobs.length}`;
            
            // Load jobs with status
            const jobsContainer = document.getElementById('crew-jobs-today');
            if (crewJobs.length === 0) {
                jobsContainer.innerHTML = '<p style="text-align: center; color: #6c757d; font-style: italic;">No jobs assigned to you today.</p>';
            } else {
                jobsContainer.innerHTML = crewJobs.map(job => generateCrewJobCard(job, 'today')).join('');
            }
        }

        function loadCrewUpcomingTab() {
            const user = AppData.currentUser;
            const today = new Date();
            
            // Get next 5 working days (excluding weekends)
            const workingDays = [];
            let currentDate = new Date(today);
            let daysAdded = 0;
            
            while (daysAdded < 5) {
                currentDate.setDate(currentDate.getDate() + 1);
                const dayOfWeek = currentDate.getDay();
                
                // Skip weekends (0 = Sunday, 6 = Saturday)
                if (dayOfWeek !== 0 && dayOfWeek !== 6) {
                    workingDays.push(new Date(currentDate));
                    daysAdded++;
                }
            }
            
            // Filter jobs for the next 5 working days
            const crewJobs = AppData.jobs.filter(job => {
                const jobDate = new Date(job.date);
                return job.crew === user.crewName && 
                       jobDate > today && 
                       workingDays.some(workDay => 
                           workDay.toDateString() === jobDate.toDateString()
                       );
            }).sort((a, b) => new Date(a.date) - new Date(b.date));
            
            const jobsContainer = document.getElementById('crew-jobs-upcoming');
            
            if (crewJobs.length === 0) {
                // Show working days preview with "no jobs" message
                const workingDaysHTML = workingDays.map(day => {
                    const dayName = day.toLocaleDateString('en-US', { weekday: 'long' });
                    const dayDate = day.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                    return `
                        <div class="working-day-preview">
                            <div class="working-day-header">
                                <span class="working-day-name">${dayName}</span>
                                <span class="working-day-date">${dayDate}</span>
                            </div>
                            <div class="working-day-status">
                                <span class="no-jobs-badge">No jobs posted yet</span>
                            </div>
                        </div>
                    `;
                }).join('');
                
                jobsContainer.innerHTML = `
                    <div class="working-days-preview">
                        <h4 style="margin-bottom: 1rem; color: #495057;">Next 5 Working Days Preview</h4>
                        ${workingDaysHTML}
                    </div>
                `;
            } else {
                // Group jobs by date
                const jobsByDate = {};
                crewJobs.forEach(job => {
                    const jobDate = new Date(job.date);
                    const dateKey = jobDate.toDateString();
                    if (!jobsByDate[dateKey]) {
                        jobsByDate[dateKey] = [];
                    }
                    jobsByDate[dateKey].push(job);
                });
                
                // Generate HTML for each working day
                const workingDaysHTML = workingDays.map(day => {
                    const dayName = day.toLocaleDateString('en-US', { weekday: 'long' });
                    const dayDate = day.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                    const dateKey = day.toDateString();
                    const dayJobs = jobsByDate[dateKey] || [];
                    
                    if (dayJobs.length === 0) {
                        return `
                            <div class="working-day-preview">
                                <div class="working-day-header">
                                    <span class="working-day-name">${dayName}</span>
                                    <span class="working-day-date">${dayDate}</span>
                                </div>
                                <div class="working-day-status">
                                    <span class="no-jobs-badge">No jobs posted yet</span>
                                </div>
                            </div>
                        `;
                    } else {
                        return `
                            <div class="working-day-preview">
                                <div class="working-day-header">
                                    <span class="working-day-name">${dayName}</span>
                                    <span class="working-day-date">${dayDate}</span>
                                    <span class="jobs-count-badge">${dayJobs.length} job${dayJobs.length > 1 ? 's' : ''}</span>
                                </div>
                                <div class="working-day-jobs">
                                    ${dayJobs.map(job => generateCrewJobCard(job, 'upcoming')).join('')}
                                </div>
                            </div>
                        `;
                    }
                }).join('');
                
                jobsContainer.innerHTML = `
                    <div class="working-days-preview">
                        <h4 style="margin-bottom: 1rem; color: #495057;">Next 5 Working Days Preview</h4>
                        ${workingDaysHTML}
                    </div>
                `;
            }
        }



        function generateCrewJobCard(job, tabType) {
            const now = new Date();
            const jobDate = new Date(job.date);
            const jobStartTime = new Date(`${job.date}T${job.startTime}`);
            const jobEndTime = new Date(`${job.date}T${job.endTime}`);
            
            // Determine job status
            let status = 'upcoming';
            let statusClass = 'upcoming';
            let statusText = 'UPCOMING';
            
            if (tabType === 'completed') {
                status = 'completed';
                statusClass = 'completed';
                statusText = 'COMPLETED';
            } else if (now >= jobStartTime && now <= jobEndTime) {
                status = 'in-progress';
                statusClass = 'in-progress';
                statusText = 'IN PROGRESS';
            } else if (now > jobEndTime && jobDate.toDateString() === now.toDateString()) {
                status = 'overdue';
                statusClass = 'overdue';
                statusText = 'OVERDUE';
            }
            
            // Format date for display
            const displayDate = jobDate.toLocaleDateString('en-US', { 
                weekday: 'short', 
                month: 'short', 
                day: 'numeric' 
            });
            
            return `
                <div class="crew-job-card ${statusClass}">
                    <div class="crew-job-status status-${status}">${statusText}</div>
                    <div class="crew-job-time">${job.startTime} - ${job.endTime}</div>
                    <div class="crew-job-address">📍 ${job.address}</div>
                    
                    <div class="crew-job-details">
                        <div class="crew-job-detail">
                            <span class="crew-job-detail-icon">📅</span>
                            ${displayDate}
                        </div>
                        <div class="crew-job-detail">
                            <span class="crew-job-detail-icon">🚗</span>
                            ${job.vehicle}
                        </div>
                        <div class="crew-job-detail">
                            <span class="crew-job-detail-icon">👥</span>
                            Crew ${job.crew}
                        </div>
                        <div class="crew-job-detail">
                            <span class="crew-job-detail-icon">📞</span>
                            ${job.siteContact || 'No contact'}
                        </div>
                    </div>
                    
                    ${job.tools.length > 0 ? `
                        <div class="crew-job-tools">
                            <h5>🛠️ Tools Needed:</h5>
                            <div class="crew-tools-list">
                                ${job.tools.map(tool => `<span class="crew-tool-tag">${tool}</span>`).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    ${job.notes ? `
                        <div class="crew-job-notes">
                            <h5>📝 Notes:</h5>
                            <p>${job.notes}</p>
                        </div>
                    ` : ''}
                    

                </div>
            `;
        }



        // Handle Enter key in login form
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && document.getElementById('login-screen').classList.contains('active')) {
                handleLogin();
            }
        });

        // Handle modal interactions
        document.addEventListener('keydown', function(e) {
            // Close modal on Escape key
            if (e.key === 'Escape') {
                const modal = document.getElementById('create-job-modal');
                if (modal.style.display === 'flex') {
                    hideCreateJobModal();
                }
            }
        });

        // Close modal when clicking outside
        document.getElementById('create-job-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideCreateJobModal();
            }
        });

        // Session restoration - check if user is already logged in
        function restoreSession() {
            if (AppData.currentUser) {
                console.log('🔄 Restoring session for:', AppData.currentUser.username);
                
                if (AppData.currentUser.role === 'admin') {
                    loadAdminDashboard();
                    showScreen('admin-dashboard');
                } else {
                    loadCrewDashboard();
                    showScreen('crew-dashboard');
                }
            } else {
                console.log('📱 No active session - showing login screen');
                showScreen('login-screen');
            }
        }

        // Initialize session on page load
        restoreSession();

        console.log('✅ Simple Schedule Pro loaded successfully!');
        console.log('💾 localStorage persistence enabled');
        console.log('📝 Job creation/editing with conflict detection enabled');
        console.log('🗑️ Job deletion with confirmation enabled');
        console.log('⚠️ Visual conflict indicators and action buttons enabled');
        console.log('📅 Calendar view with color-coded crews enabled');
        console.log('👤 Test users: admin/admin123, crew_a/crewa123, crew_b/crewb123');
        console.log('🚀 Admin can now create, edit, delete jobs and view them in calendar format!');

        // Documents Module Functions
        function loadCrewDocumentsTab() {
            const user = AppData.currentUser;
            const crewDocuments = AppData.documents.filter(doc => doc.assignedCrew === user.crewName);
            
            const documentsContainer = document.getElementById('crew-documents');
            
            // Always show the Create Document button at the top
            let documentsHTML = `
                <div style="margin-bottom: 2rem; text-align: center;">
                    <button type="button" class="btn" onclick="showCreateDocumentModal()" style="background: #007bff; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: 1rem;">
                        📝 Create New Document
                    </button>
                </div>
            `;
            
            if (crewDocuments.length === 0) {
                documentsHTML += `
                    <div style="text-align: center; padding: 2rem; color: #6c757d;">
                        <h4>No documents assigned</h4>
                        <p>You don't have any documents to fill out at this time.</p>
                    </div>
                `;
                documentsContainer.innerHTML = documentsHTML;
                return;
            }
            
            // Group documents by category
            const categories = {
                'safety': crewDocuments.filter(doc => doc.category === 'safety'),
                'work': crewDocuments.filter(doc => doc.category === 'work'),
                'equipment': crewDocuments.filter(doc => doc.category === 'equipment'),
                'other': crewDocuments.filter(doc => !['safety', 'work', 'equipment'].includes(doc.category))
            };
            
            // Add existing documents to the HTML
            Object.keys(categories).forEach(category => {
                const docs = categories[category];
                if (docs.length === 0) return;
                
                const categoryNames = {
                    'safety': '🛡️ Safety Documents',
                    'work': '📋 Work Documents',
                    'equipment': '🔧 Equipment Documents',
                    'other': '📄 Other Documents'
                };
                
                documentsHTML += `
                    <div class="document-category">
                        <div class="document-category-header">
                            <h4>${categoryNames[category]}</h4>
                        </div>
                        <div class="document-list">
                            ${docs.map(doc => generateDocumentItem(doc)).join('')}
                        </div>
                    </div>
                `;
            });
            
            documentsContainer.innerHTML = documentsHTML;
        }

        function generateDocumentItem(doc) {
            const statusClass = doc.status === 'completed' ? 'completed' : 
                               doc.status === 'overdue' ? 'overdue' : '';
            
            const statusText = doc.status === 'completed' ? 'COMPLETED' :
                              doc.status === 'overdue' ? 'OVERDUE' : 'PENDING';
            
            const statusClassCSS = doc.status === 'completed' ? 'status-completed' :
                                  doc.status === 'overdue' ? 'status-overdue' : 'status-pending';
            
            const dueDate = new Date(doc.dueDate).toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric' 
            });
            
            return `
                <div class="document-item ${statusClass}">
                    <div class="document-header">
                        <div class="document-title">${doc.title}</div>
                        <div class="document-status ${statusClassCSS}">${statusText}</div>
                    </div>
                    <div class="document-description">${doc.description}</div>
                    <div class="document-meta">
                        <span>📅 Due: ${dueDate}</span>
                        <span>👥 Crew ${doc.assignedCrew}</span>
                    </div>
                    <div class="document-actions">
                        ${doc.status === 'completed' ? `
                            <button type="button" class="btn-document btn-view-document" onclick="viewDocument(${doc.id})">
                                👁️ View
                            </button>
                        ` : `
                            <button type="button" class="btn-document btn-fill-document" onclick="fillDocument(${doc.id})">
                                ✏️ Fill Out
                            </button>
                        `}
                    </div>
                </div>
            `;
        }

        function showCreateDocumentModal() {
            // Clear the form
            document.getElementById('document-form').reset();
            delete document.getElementById('document-form').dataset.documentId;
            
            // Clear document type and content
            document.getElementById('document-type').value = '';
            document.getElementById('document-content').innerHTML = `
                <div class="form-section">
                    <h4>📝 Document Content</h4>
                    <p style="color: #6c757d; font-style: italic;">Select a document type to load the template.</p>
                </div>
            `;
            
            // Show the modal
            document.getElementById('document-form-modal').style.display = 'flex';
            document.getElementById('document-form-title').textContent = 'Create New Document';
        }

        function fillDocument(docId) {
            const doc = AppData.documents.find(d => d.id === docId);
            if (!doc) {
                alert('Document not found!');
                return;
            }
            
            // Set document type and load template
            document.getElementById('document-type').value = doc.type;
            
            // Load the document template
            loadDocumentTemplate();
            
            // Show the modal
            document.getElementById('document-form-modal').style.display = 'flex';
            document.getElementById('document-form-title').textContent = `Fill Out: ${doc.title}`;
            
            // Store the document ID for saving
            document.getElementById('document-form').dataset.documentId = docId;
        }

        function viewDocument(docId) {
            const doc = AppData.documents.find(d => d.id === docId);
            if (!doc || !doc.data) {
                alert('Document data not available!');
                return;
            }
            
            let content = `<h4>${doc.title}</h4>`;
            content += `<p><strong>Completed:</strong> ${new Date(doc.completedAt).toLocaleDateString()}</p>`;
            content += `<p><strong>Completed by:</strong> ${doc.data.crewMemberName || 'Unknown'}</p>`;
            
            // Display document-specific data
            if (doc.type === 'safety-checklist') {
                content += `<h5>Safety Checklist Results:</h5>`;
                content += `<ul>`;
                Object.keys(doc.data).forEach(key => {
                    if (key !== 'crewMemberName' && key !== 'jobSite') {
                        content += `<li><strong>${key}:</strong> ${doc.data[key]}</li>`;
                    }
                });
                content += `</ul>`;
            } else if (doc.type === 'equipment-inspection') {
                content += `<h5>Equipment Inspection Results:</h5>`;
                content += `<ul>`;
                Object.keys(doc.data).forEach(key => {
                    content += `<li><strong>${key}:</strong> ${Array.isArray(doc.data[key]) ? doc.data[key].join(', ') : doc.data[key]}</li>`;
                });
                content += `</ul>`;
            } else if (doc.type === 'daily-job-record') {
                content += `<h5>Daily Job Record Data:</h5>`;
                content += `<div style="max-height: 400px; overflow-y: auto;">`;
                content += `<p><strong>Company:</strong> ${doc.data.companyName || 'N/A'}</p>`;
                content += `<p><strong>Project:</strong> ${doc.data.projectName || 'N/A'}</p>`;
                content += `<p><strong>Work Description:</strong> ${doc.data.workDescription || 'N/A'}</p>`;
                content += `<p><strong>Site Contact:</strong> ${doc.data.siteContact || 'N/A'}</p>`;
                content += `<p><strong>Job Complete:</strong> ${doc.data.jobComplete || 'N/A'}</p>`;
                content += `<p><strong>Comments:</strong> ${doc.data.comments || 'N/A'}</p>`;
                content += `</div>`;
            } else {
                content += `<h5>Document Data:</h5>`;
                content += `<pre>${JSON.stringify(doc.data, null, 2)}</pre>`;
            }
            
            alert(content);
        }

        function loadDocumentTemplate() {
            const docType = document.getElementById('document-type').value;
            const contentDiv = document.getElementById('document-content');
            
            // Clear the content div first to prevent duplicate IDs
            contentDiv.innerHTML = '';
            
            if (!docType) {
                contentDiv.innerHTML = `
                    <div class="form-section">
                        <h4>📝 Document Content</h4>
                        <p style="color: #6c757d; font-style: italic;">Select a document type to load the template.</p>
                    </div>
                `;
                return;
            }
            
            let templateHTML = '<div class="form-section"><h4>📝 Document Content</h4>';
            
            switch (docType) {
                case 'safety-checklist':
                    templateHTML += `
                        <div class="checkbox-group">
                            <h5>Safety Inspection Items:</h5>
                            <div class="checkbox-item">
                                <input type="checkbox" id="safety-ppe" name="safety-ppe">
                                <label for="safety-ppe">Personal Protective Equipment (PPE) worn</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="safety-tools" name="safety-tools">
                                <label for="safety-tools">Tools and equipment in good condition</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="safety-area" name="safety-area">
                                <label for="safety-area">Work area is clean and organized</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="safety-weather" name="safety-weather">
                                <label for="safety-weather">Weather conditions are safe for work</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="safety-emergency" name="safety-emergency">
                                <label for="safety-emergency">Emergency contact information available</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="safety-notes">Additional Safety Notes</label>
                            <textarea id="safety-notes" rows="3" placeholder="Any safety concerns or observations"></textarea>
                        </div>
                    `;
                    break;
                    
                case 'work-order':
                    templateHTML += `
                        <div class="form-row">
                            <div class="form-group">
                                <label for="work-description">Work Description</label>
                                <textarea id="work-description" rows="3" placeholder="Describe the work performed"></textarea>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="materials-used">Materials Used</label>
                                <textarea id="materials-used" rows="2" placeholder="List materials and quantities"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="hours-worked">Hours Worked</label>
                                <input type="number" id="hours-worked" min="0" step="0.5" placeholder="8.5">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="work-notes">Additional Notes</label>
                            <textarea id="work-notes" rows="2" placeholder="Any issues, delays, or special instructions"></textarea>
                        </div>
                    `;
                    break;
                    
                case 'incident-report':
                    templateHTML += `
                        <div class="form-row">
                            <div class="form-group">
                                <label for="incident-time">Time of Incident</label>
                                <input type="time" id="incident-time" required>
                            </div>
                            <div class="form-group">
                                <label for="incident-severity">Severity Level</label>
                                <select id="incident-severity" required>
                                    <option value="">Select Severity</option>
                                    <option value="minor">Minor</option>
                                    <option value="moderate">Moderate</option>
                                    <option value="major">Major</option>
                                    <option value="critical">Critical</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="incident-description">Incident Description</label>
                            <textarea id="incident-description" rows="4" placeholder="Describe what happened"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="incident-actions">Actions Taken</label>
                            <textarea id="incident-actions" rows="3" placeholder="What actions were taken in response"></textarea>
                        </div>
                    `;
                    break;
                    
                case 'equipment-inspection':
                    templateHTML += `
                        <div class="form-group">
                            <label for="equipment-list">Equipment Inspected</label>
                            <textarea id="equipment-list" rows="2" placeholder="List all equipment inspected"></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="inspection-condition">Overall Condition</label>
                                <select id="inspection-condition" required>
                                    <option value="">Select Condition</option>
                                    <option value="excellent">Excellent</option>
                                    <option value="good">Good</option>
                                    <option value="fair">Fair</option>
                                    <option value="poor">Poor</option>
                                    <option value="unsafe">Unsafe</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="maintenance-needed">Maintenance Needed</label>
                                <select id="maintenance-needed" required>
                                    <option value="">Select Maintenance</option>
                                    <option value="none">None</option>
                                    <option value="minor">Minor</option>
                                    <option value="major">Major</option>
                                    <option value="replacement">Replacement</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="inspection-notes">Inspection Notes</label>
                            <textarea id="inspection-notes" rows="3" placeholder="Detailed notes about the inspection"></textarea>
                        </div>
                    `;
                    break;
                    
                case 'time-sheet':
                    templateHTML += `
                        <div class="form-row">
                            <div class="form-group">
                                <label for="start-time">Start Time</label>
                                <input type="time" id="start-time" required>
                            </div>
                            <div class="form-group">
                                <label for="end-time">End Time</label>
                                <input type="time" id="end-time" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="break-time">Break Time (minutes)</label>
                                <input type="number" id="break-time" min="0" value="30">
                            </div>
                            <div class="form-group">
                                <label for="total-hours">Total Hours</label>
                                <input type="number" id="total-hours" min="0" step="0.25" readonly>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="work-activities">Work Activities</label>
                            <textarea id="work-activities" rows="3" placeholder="List activities performed"></textarea>
                        </div>
                    `;
                    break;
                    
                case 'material-request':
                    templateHTML += `
                        <div class="form-group">
                            <label for="materials-needed">Materials Needed</label>
                            <textarea id="materials-needed" rows="3" placeholder="List materials, quantities, and specifications"></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="priority-level">Priority Level</label>
                                <select id="priority-level" required>
                                    <option value="">Select Priority</option>
                                    <option value="low">Low</option>
                                    <option value="medium">Medium</option>
                                    <option value="high">High</option>
                                    <option value="urgent">Urgent</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="needed-by">Needed By</label>
                                <input type="date" id="needed-by" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="request-reason">Reason for Request</label>
                            <textarea id="request-reason" rows="2" placeholder="Explain why these materials are needed"></textarea>
                        </div>
                    `;
                    break;
                    
                case 'flha':
                    templateHTML += `
                        <div class="form-section">
                            <div style="text-align: center; margin-bottom: 1rem;">
                                <div style="font-size: 1.5em; font-weight: bold; color: #004080; margin-bottom: 5px;">Brothers Cutting & Coring</div>
                                <h4 style="color: #004080; margin: 0;">Field Level Hazard Assessment (FLHA)</h4>
                            </div>
                            
                            <!-- Job Info -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Job Info</legend>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="flha-name">Name</label>
                                        <input type="text" id="flha-name" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="flha-date">Date</label>
                                        <input type="date" id="flha-date" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="flha-time">Time</label>
                                        <input type="time" id="flha-time" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="flha-weather">Weather Conditions</label>
                                        <input type="text" id="flha-weather" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="flha-site-address">Job Site Address</label>
                                        <input type="text" id="flha-site-address" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="flha-task-area">Task / Work Area</label>
                                        <input type="text" id="flha-task-area" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="flha-muster-point">Muster Point</label>
                                    <input type="text" id="flha-muster-point" required>
                                </div>
                            </fieldset>

                            <!-- Documentation / Permits -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Documentation / Permits</legend>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="permit-work" name="permit-work">
                                        <label for="permit-work">Permit to work reviewed</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="fire-watch" name="fire-watch">
                                        <label for="fire-watch">Fire watch</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="confined-space" name="confined-space">
                                        <label for="confined-space">Confined space assessment</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="ground-disturbance" name="ground-disturbance">
                                        <label for="ground-disturbance">Ground disturbance</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="equipment-logs" name="equipment-logs">
                                        <label for="equipment-logs">Equipment logs</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="lockout" name="lockout">
                                        <label for="lockout">Lockout</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="fall-protection" name="fall-protection">
                                        <label for="fall-protection">Fall protection plan</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="critical-lift" name="critical-lift">
                                        <label for="critical-lift">Critical lift plan</label>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Working at Heights / Fall Hazards -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Working at Heights / Fall Hazards</legend>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="harness-required" name="harness-required">
                                        <label for="harness-required">Harness required / inspected / tie-off identified</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="others-working" name="others-working">
                                        <label for="others-working">Others working below / overhead</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="falls-height" name="falls-height">
                                        <label for="falls-height">Falls from height</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="hoisting-loads" name="hoisting-loads">
                                        <label for="hoisting-loads">Hoisting or moving loads overhead / around area</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="working-overhead" name="working-overhead">
                                        <label for="working-overhead">Working overhead / tight spaces</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="objects-falling" name="objects-falling">
                                        <label for="objects-falling">Objects / debris falling from above</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="barricades" name="barricades">
                                        <label for="barricades">Barricades / signs / hole covers</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="overhead-obstructions" name="overhead-obstructions">
                                        <label for="overhead-obstructions">Overhead obstructions / power lines</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="fall-protection-log" name="fall-protection-log">
                                        <label for="fall-protection-log">Fall protection - inspection log completed</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="manbasket" name="manbasket">
                                        <label for="manbasket">Manbasket - review procedure / complete critical lift</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="aerial-lift" name="aerial-lift">
                                        <label for="aerial-lift">Aerial lift - operator trained, inspection, manual</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="other-heights" name="other-heights">
                                        <label for="other-heights">Other</label>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Emergency Plan / Equipment -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Emergency Plan / Equipment</legend>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="emergency-plan" name="emergency-plan">
                                        <label for="emergency-plan">Aware of emergency response plan</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="communication" name="communication">
                                        <label for="communication">Communication: radio, phone, air horn</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="cso-identified" name="cso-identified">
                                        <label for="cso-identified">CSO / first aid attendant identified</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="eye-wash" name="eye-wash">
                                        <label for="eye-wash">Eye wash in work area</label>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Protective Equipment -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Protective Equipment</legend>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="respiratory-protection" name="respiratory-protection">
                                        <label for="respiratory-protection">Respiratory protection</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="hardhat-protection" name="hardhat-protection">
                                        <label for="hardhat-protection">Hardhat, eye protection, boots, hi-vis</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="pfd" name="pfd">
                                        <label for="pfd">Personal flotation device (PFD)</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="goggles" name="goggles">
                                        <label for="goggles">Goggles / face shield</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="gloves" name="gloves">
                                        <label for="gloves">Cloth / leather / rubber gloves</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="coveralls" name="coveralls">
                                        <label for="coveralls">Coveralls (FR, Tyvek, cotton)</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="hearing-protection" name="hearing-protection">
                                        <label for="hearing-protection">Hearing protection (plugs / muffs)</label>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Environmental Assessment -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Environmental Assessment</legend>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="spill-response" name="spill-response">
                                        <label for="spill-response">Spill response plan / supplies</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="lighting-levels" name="lighting-levels">
                                        <label for="lighting-levels">Lighting levels appropriate for task</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="refueling-equipment" name="refueling-equipment">
                                        <label for="refueling-equipment">Refueling equipment / containment</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="erosion-sediment" name="erosion-sediment">
                                        <label for="erosion-sediment">Erosion and / or sediment issues</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="wildlife" name="wildlife">
                                        <label for="wildlife">Wildlife in area</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="heat-cold" name="heat-cold">
                                        <label for="heat-cold">Exposure to heat / cold</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="silica-exposure" name="silica-exposure">
                                        <label for="silica-exposure">Silica Exposure - ECP Completed?</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="weather-wind" name="weather-wind">
                                        <label for="weather-wind">Weather / wind</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="tide-current" name="tide-current">
                                        <label for="tide-current">Tide / current / swells</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="waste-material" name="waste-material">
                                        <label for="waste-material">Waste material properly stored / labeled</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="weld-fumes" name="weld-fumes">
                                        <label for="weld-fumes">Weld fumes</label>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Limitations / Hazards -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Limitations / Hazards</legend>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="procedure-not-available" name="procedure-not-available">
                                        <label for="procedure-not-available">Procedure not available for task</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="confusing-instructions" name="confusing-instructions">
                                        <label for="confusing-instructions">Confusing instructions</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="no-training-task" name="no-training-task">
                                        <label for="no-training-task">No training in task</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="no-training-tools" name="no-training-tools">
                                        <label for="no-training-tools">No training with tools to be used</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="first-time-task" name="first-time-task">
                                        <label for="first-time-task">First time performing this task</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="new-worker" name="new-worker">
                                        <label for="new-worker">New worker on crew</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="physically-prepared" name="physically-prepared">
                                        <label for="physically-prepared">Physically prepared / mentally focused</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="awkward-load" name="awkward-load">
                                        <label for="awkward-load">Awkward load / heavy load</label>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Access / Egress -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Access / Egress</legend>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="scaffolding-approved" name="scaffolding-approved">
                                        <label for="scaffolding-approved">Scaffolding system approved</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="ladder-secured" name="ladder-secured">
                                        <label for="ladder-secured">Ladder secured top and bottom</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="confined-space-entry" name="confined-space-entry">
                                        <label for="confined-space-entry">Confined space - Entry / Exit plan</label>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Other Hazards -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Other Hazards</legend>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="whmis-sds" name="whmis-sds">
                                        <label for="whmis-sds">WHMIS - SDS Available</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="electrical-cords" name="electrical-cords">
                                        <label for="electrical-cords">Electrical cords / plugs - colour tag?</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="spotters-cranes" name="spotters-cranes">
                                        <label for="spotters-cranes">Spotters / cranes / mobile equipment</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="rigging-certificates" name="rigging-certificates">
                                        <label for="rigging-certificates">Rigging - Certificates / inspections</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="hot-work-firewatch" name="hot-work-firewatch">
                                        <label for="hot-work-firewatch">Hot work - Fire watch?</label>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Job Steps & Hazards -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Job Steps & Hazards</legend>
                                <table class="table" id="hazard-rows" style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                                    <thead>
                                        <tr>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Job Step</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Hazards</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Controls</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" style="width: 100%; border: none; outline: none;"></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button type="button" onclick="addHazardRow()" style="margin-top: 10px; padding: 8px 12px; background-color: #004080; color: white; border: none; border-radius: 4px; cursor: pointer;">Add Step</button>
                            </fieldset>

                            <!-- Personnel Acknowledgement -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Personnel Acknowledgement</legend>
                                <table class="table" id="crew-signatures" style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                                    <thead>
                                        <tr>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">#</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Name</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Signature</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="border: 1px solid #ccc; padding: 8px;">1</td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" style="width: 100%; border: none; outline: none;"></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button type="button" onclick="addSignatureRow()" style="margin-top: 10px; padding: 8px 12px; background-color: #004080; color: white; border: none; border-radius: 4px; cursor: pointer;">Add Person</button>
                                <div class="form-row" style="margin-top: 15px;">
                                    <div class="form-group">
                                        <label for="foreman-signature">Foreman's Signature</label>
                                        <input type="text" id="foreman-signature">
                                    </div>
                                    <div class="form-group">
                                        <label for="foreman-date">Date and Time Foreman Signed</label>
                                        <input type="text" id="foreman-date">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="superintendent-signature">Superintendent's Signature</label>
                                        <input type="text" id="superintendent-signature">
                                    </div>
                                    <div class="form-group">
                                        <label for="superintendent-date">Date</label>
                                        <input type="text" id="superintendent-date">
                                    </div>
                                </div>
                            </fieldset>

                            <!-- End-of-Shift Review -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">End-of-Shift Review</legend>
                                <div class="form-group">
                                    <label>Any incidents or near misses?</label>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="incidents-yes" name="incidents-yes">
                                        <label for="incidents-yes">Yes</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="incidents-no" name="incidents-no">
                                        <label for="incidents-no">No</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="incidents-who">If yes, who?</label>
                                    <input type="text" id="incidents-who">
                                </div>
                                <div class="form-group">
                                    <label>Was it reported to a supervisor?</label>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="reported-yes" name="reported-yes">
                                        <label for="reported-yes">Yes</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="reported-no" name="reported-no">
                                        <label for="reported-no">No</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="reported-to">Who was it reported to?</label>
                                    <input type="text" id="reported-to">
                                </div>
                                <div class="form-group">
                                    <label>Was the area cleaned up?</label>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="cleaned-yes" name="cleaned-yes">
                                        <label for="cleaned-yes">Yes</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="cleaned-no" name="cleaned-no">
                                        <label for="cleaned-no">No</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="concerns">Any concerns?</label>
                                    <textarea id="concerns" rows="3" placeholder="Write any concerns here..."></textarea>
                                </div>
                            </fieldset>

                            <!-- Safety Officer Email -->
                            <div class="form-group">
                                <label for="safety-officer-email">Safety Officer Email</label>
                                <input type="email" id="safety-officer-email" required placeholder="safety@company.com">
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'daily-job-record':
                    templateHTML += `
                        <div class="form-section">
                            <div style="text-align: center; margin-bottom: 1rem;">
                                <div style="font-size: 1.5em; font-weight: bold; color: #004080; margin-bottom: 5px;">BROTHERS CUTTING AND CORING</div>
                                <h4 style="color: #004080; margin: 0;">DJR Daily Job Record</h4>
                            </div>
                            
                            <!-- Company Information -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Company Information</legend>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="djr-company-name">Company Name</label>
                                        <input type="text" id="djr-company-name" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-po-number">PO#</label>
                                        <input type="text" id="djr-po-number" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-date">Date</label>
                                        <input type="date" id="djr-date" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="djr-company-address">Company Address</label>
                                        <input type="text" id="djr-company-address" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-project-name">Project Name</label>
                                        <input type="text" id="djr-project-name" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="djr-work-ordered-by">Work Ordered By</label>
                                        <input type="text" id="djr-work-ordered-by" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-project-address">Project Address</label>
                                        <input type="text" id="djr-project-address" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="djr-phone">Phone</label>
                                        <input type="tel" id="djr-phone" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-email">Email</label>
                                        <input type="email" id="djr-email" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-site-contact">Site Contact</label>
                                        <input type="text" id="djr-site-contact" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-call">Call</label>
                                        <input type="text" id="djr-call" required>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Detailed Description of Work -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Detailed Description of Work</legend>
                                <div class="form-group">
                                    <textarea id="djr-work-description" rows="6" style="width: 100%; height: 150px;" placeholder="Describe the work performed in detail"></textarea>
                                </div>
                            </fieldset>

                            <!-- Services & Tool Hours -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Services & Tool Hours</legend>
                                <table style="width: 100%; border-collapse: collapse; margin-bottom: 10px;">
                                    <thead>
                                        <tr style="background-color: #eee;">
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Service</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Tool Hours</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr><td style="border: 1px solid #ccc; padding: 8px;">Slab Sawing</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-slab-sawing" style="width: 100%; border: none; outline: none;"></td></tr>
                                        <tr><td style="border: 1px solid #ccc; padding: 8px;">Wall Sawing</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-wall-sawing" style="width: 100%; border: none; outline: none;"></td></tr>
                                        <tr><td style="border: 1px solid #ccc; padding: 8px;">Wire Sawing</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-wire-sawing" style="width: 100%; border: none; outline: none;"></td></tr>
                                        <tr><td style="border: 1px solid #ccc; padding: 8px;">Core Drilling</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-core-drilling" style="width: 100%; border: none; outline: none;"></td></tr>
                                        <tr><td style="border: 1px solid #ccc; padding: 8px;">Hicycle Drilling</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-hicycle-drilling" style="width: 100%; border: none; outline: none;"></td></tr>
                                        <tr><td style="border: 1px solid #ccc; padding: 8px;">Hand Sawing</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-hand-sawing" style="width: 100%; border: none; outline: none;"></td></tr>
                                        <tr><td style="border: 1px solid #ccc; padding: 8px;">Excavator</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-excavator" style="width: 100%; border: none; outline: none;"></td></tr>
                                        <tr><td style="border: 1px solid #ccc; padding: 8px;">Skid Steer</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-skid-steer" style="width: 100%; border: none; outline: none;"></td></tr>
                                        <tr><td style="border: 1px solid #ccc; padding: 8px;">Demolition Robot</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-demolition-robot" style="width: 100%; border: none; outline: none;"></td></tr>
                                        <tr><td style="border: 1px solid #ccc; padding: 8px;">Jackhammer</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-jackhammer" style="width: 100%; border: none; outline: none;"></td></tr>
                                        <tr><td style="border: 1px solid #ccc; padding: 8px;">Foreman</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-foreman" style="width: 100%; border: none; outline: none;"></td></tr>
                                        <tr><td style="border: 1px solid #ccc; padding: 8px;">Labour</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-labour" style="width: 100%; border: none; outline: none;"></td></tr>
                                        <tr><td style="border: 1px solid #ccc; padding: 8px;">Other</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-other" style="width: 100%; border: none; outline: none;"></td></tr>
                                    </tbody>
                                </table>
                            </fieldset>

                            <!-- Site Resources -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Site Resources</legend>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="djr-slurry-barrels">Slurry Barrels</label>
                                        <input type="text" id="djr-slurry-barrels">
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-generator">Generator</label>
                                        <input type="text" id="djr-generator">
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-pigtail">Pigtail</label>
                                        <input type="text" id="djr-pigtail">
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-bins">Bins</label>
                                        <input type="text" id="djr-bins">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="djr-equipment-left">Equipment left on site?</label>
                                        <input type="text" id="djr-equipment-left" placeholder="Yes/No">
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-job-complete">Is job complete?</label>
                                        <input type="text" id="djr-job-complete" placeholder="Yes/No">
                                    </div>
                                </div>
                            </fieldset>

                            <!-- BCC Employee Time Log -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">BCC Employee Time Log</legend>
                                <table style="width: 100%; border-collapse: collapse; margin-bottom: 10px;">
                                    <thead>
                                        <tr style="background-color: #eee;">
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Employee</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Regular</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">O/T</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">D/T</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Gear Up/Down</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Travel</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Shop</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Total Hours</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp1-name" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp1-regular" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp1-ot" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp1-dt" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp1-gear" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp1-travel" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp1-shop" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp1-total" style="width: 100%; border: none; outline: none;"></td>
                                        </tr>
                                        <tr>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp2-name" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp2-regular" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp2-ot" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp2-dt" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp2-gear" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp2-travel" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp2-shop" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp2-total" style="width: 100%; border: none; outline: none;"></td>
                                        </tr>
                                        <tr>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp3-name" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp3-regular" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp3-ot" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp3-dt" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp3-gear" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp3-travel" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp3-shop" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp3-total" style="width: 100%; border: none; outline: none;"></td>
                                        </tr>
                                        <tr>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp4-name" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp4-regular" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp4-ot" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp4-dt" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp4-gear" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp4-travel" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp4-shop" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp4-total" style="width: 100%; border: none; outline: none;"></td>
                                        </tr>
                                        <tr>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp5-name" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp5-regular" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp5-ot" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp5-dt" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp5-gear" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp5-travel" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp5-shop" style="width: 100%; border: none; outline: none;"></td>
                                            <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="djr-emp5-total" style="width: 100%; border: none; outline: none;"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </fieldset>

                            <!-- Standby -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Standby</legend>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="djr-standby-start">Start Time</label>
                                        <input type="time" id="djr-standby-start">
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-standby-finish">Finish Time</label>
                                        <input type="time" id="djr-standby-finish">
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-standby-hours">Standby Hours</label>
                                        <input type="text" id="djr-standby-hours">
                                    </div>
                                    <div class="form-group">
                                        <label for="djr-standby-reason">Reason for Standby Time</label>
                                        <textarea id="djr-standby-reason" rows="1" style="width: 100%; height: 80px;"></textarea>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Signatures -->
                            <div style="display: flex; gap: 20px; margin-top: 20px;">
                                <div class="form-group" style="flex: 1;">
                                    <label for="djr-operator-signature">Operator Signature</label>
                                    <input type="text" id="djr-operator-signature">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label for="djr-customer-signature">Customer Signature</label>
                                    <input type="text" id="djr-customer-signature">
                                </div>
                            </div>

                            <!-- Comments -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Comments</legend>
                                <div class="form-group">
                                    <textarea id="djr-comments" rows="4" style="width: 100%; height: 80px;" placeholder="Comments..."></textarea>
                                </div>
                            </fieldset>
                        </div>
                    `;
                    break;
                    
                case 'silica-exposure-plan':
                    templateHTML += `
                        <div class="form-section">
                            <div style="text-align: center; margin-bottom: 1rem;">
                                <div style="font-size: 1.5em; font-weight: bold; color: #004080; margin-bottom: 5px;">BROTHERS CUTTING AND CORING</div>
                                <h4 style="color: #004080; margin: 0;">Silica Exposure Control Plan</h4>
                            </div>
                            
                            <!-- General Info -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">General Info</legend>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px 20px;">
                                    <div class="form-group">
                                        <label for="sep-date-completed">Date Plan Completed</label>
                                        <input type="date" id="sep-date-completed" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="sep-prepared-by">Prepared By</label>
                                        <input type="text" id="sep-prepared-by" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="sep-company">Company</label>
                                        <input type="text" id="sep-company" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="sep-superintendent">Superintendent</label>
                                        <input type="text" id="sep-superintendent" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="sep-supervisor">Supervisor</label>
                                        <input type="text" id="sep-supervisor" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="sep-work-duration">Work Duration (days/hours)</label>
                                        <input type="text" id="sep-work-duration" required>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Tasks -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Tasks</legend>
                                <table style="width: 100%; border-collapse: collapse; margin-bottom: 10px;" id="sep-tasks-table">
                                    <thead>
                                        <tr style="background-color: #eee;">
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Task</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="border: 1px solid #ccc; padding: 8px;">
                                                <input type="text" id="sep-task-1" style="width: 100%; border: none; outline: none;">
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button type="button" onclick="addSEPTask()" style="background: #004080; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Add Task</button>
                            </fieldset>

                            <!-- Controls -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Controls</legend>
                                <table style="width: 100%; border-collapse: collapse; margin-bottom: 10px;" id="sep-controls-table">
                                    <thead>
                                        <tr style="background-color: #eee;">
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Control</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="border: 1px solid #ccc; padding: 8px;">
                                                <input type="text" id="sep-control-1" style="width: 100%; border: none; outline: none;">
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button type="button" onclick="addSEPControl()" style="background: #004080; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Add Control</button>
                            </fieldset>

                            <!-- Tools -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Tools</legend>
                                <table style="width: 100%; border-collapse: collapse; margin-bottom: 10px;" id="sep-tools-table">
                                    <thead>
                                        <tr style="background-color: #eee;">
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Tool</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="border: 1px solid #ccc; padding: 8px;">
                                                <input type="text" id="sep-tool-1" style="width: 100%; border: none; outline: none;">
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button type="button" onclick="addSEPTool()" style="background: #004080; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Add Tool</button>
                            </fieldset>

                            <!-- Respirator & PPE -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Respirator & PPE</legend>
                                <div class="form-group">
                                    <label for="sep-respirator-type">Respirator Type</label>
                                    <input type="text" id="sep-respirator-type" required>
                                </div>
                                <div class="form-group">
                                    <label for="sep-ppe">Personal Protective Equipment</label>
                                    <textarea id="sep-ppe" rows="2" style="width: 100%; height: 60px;" placeholder="Describe required PPE"></textarea>
                                </div>
                            </fieldset>

                            <!-- Procedures & Hazards -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Procedures & Hazards</legend>
                                <div class="form-group">
                                    <label for="sep-housekeeping">Housekeeping / Disposal Procedures</label>
                                    <textarea id="sep-housekeeping" rows="2" style="width: 100%; height: 60px;" placeholder="Describe housekeeping and disposal procedures"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="sep-other-hazards">Other Hazards</label>
                                    <textarea id="sep-other-hazards" rows="2" style="width: 100%; height: 60px;" placeholder="Describe other hazards"></textarea>
                                </div>
                            </fieldset>

                            <!-- Other Required Documents -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Other Required Documents</legend>
                                <div style="display: grid; grid-template-columns: repeat(4, auto); grid-column-gap: 20px; grid-row-gap: 10px; margin-top: 10px;">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-air-monitoring" name="sep-air-monitoring">
                                        <label for="sep-air-monitoring">Air Monitoring</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-written-silica" name="sep-written-silica">
                                        <label for="sep-written-silica">Written Silica Work Procedure</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-respiratory-fit-test" name="sep-respiratory-fit-test">
                                        <label for="sep-respiratory-fit-test">Respiratory Fit Test</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-silica-ventilation" name="sep-silica-ventilation">
                                        <label for="sep-silica-ventilation">Silica Indoor Ventilation Plan</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-confined-entry" name="sep-confined-entry">
                                        <label for="sep-confined-entry">Confined Entry</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-worker-training" name="sep-worker-training">
                                        <label for="sep-worker-training">Worker Training</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-respiratory-control" name="sep-respiratory-control">
                                        <label for="sep-respiratory-control">Respiratory Control Plan</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-fall-protection-plan" name="sep-fall-protection-plan">
                                        <label for="sep-fall-protection-plan">Fall Protection Plan</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-documents-other" name="sep-documents-other">
                                        <label for="sep-documents-other">Other</label>
                                        <input type="text" id="sep-documents-other-specify" placeholder="Specify" style="width: 150px; margin-left: 5px;">
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Other Controls -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Other Controls</legend>
                                <div style="display: grid; grid-template-columns: repeat(4, auto); grid-column-gap: 20px; grid-row-gap: 10px; margin-top: 10px;">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-wet-work" name="sep-wet-work">
                                        <label for="sep-wet-work">Wet Work</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-controls-air-monitoring" name="sep-controls-air-monitoring">
                                        <label for="sep-controls-air-monitoring">Air Monitoring</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-coveralls" name="sep-coveralls">
                                        <label for="sep-coveralls">Coveralls</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-fall-protection" name="sep-fall-protection">
                                        <label for="sep-fall-protection">Fall Protection</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-isolation" name="sep-isolation">
                                        <label for="sep-isolation">Isolation</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-access-restricted" name="sep-access-restricted">
                                        <label for="sep-access-restricted">Access Restricted</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-gloves" name="sep-gloves">
                                        <label for="sep-gloves">Gloves</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-hearing-protection" name="sep-hearing-protection">
                                        <label for="sep-hearing-protection">Hearing Protection</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-ventilation" name="sep-ventilation">
                                        <label for="sep-ventilation">Ventilation</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-scheduling" name="sep-scheduling">
                                        <label for="sep-scheduling">Scheduling</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-reflective-vest" name="sep-reflective-vest">
                                        <label for="sep-reflective-vest">Reflective Vest</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-personal-fitted" name="sep-personal-fitted">
                                        <label for="sep-personal-fitted">Personal Fitted</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-vacuum" name="sep-vacuum">
                                        <label for="sep-vacuum">Vacuum</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-signage" name="sep-signage">
                                        <label for="sep-signage">Signage</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-eye-protection" name="sep-eye-protection">
                                        <label for="sep-eye-protection">Eye Protection</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-respirator" name="sep-respirator">
                                        <label for="sep-respirator">Respirator</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="sep-controls-other" name="sep-controls-other">
                                        <label for="sep-controls-other">Other</label>
                                        <input type="text" id="sep-controls-other-specify" placeholder="Specify" style="width: 150px; margin-left: 5px;">
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Workers On Site -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Workers On Site</legend>
                                <table style="width: 100%; border-collapse: collapse; margin-bottom: 10px;" id="sep-workers-table">
                                    <thead>
                                        <tr style="background-color: #eee;">
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">#</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Name</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Signature</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="border: 1px solid #ccc; padding: 8px;">1</td>
                                            <td style="border: 1px solid #ccc; padding: 8px;">
                                                <input type="text" id="sep-worker1-name" style="width: 100%; border: none; outline: none;">
                                            </td>
                                            <td style="border: 1px solid #ccc; padding: 8px;">
                                                <input type="text" id="sep-worker1-signature" style="width: 100%; border: none; outline: none;">
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button type="button" onclick="addSEPWorker()" style="background: #004080; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Add Worker</button>
                            </fieldset>
                        </div>
                    `;
                    break;
                    
                case 'safe-work-procedure':
                    templateHTML += `
                        <div class="form-section">
                            <div style="text-align: center; margin-bottom: 1rem;">
                                <div style="font-size: 1.5em; font-weight: bold; color: #004080; margin-bottom: 5px;">BROTHERS CUTTING AND CORING</div>
                                <h4 style="color: #004080; margin: 0;">SWP Safe Work Procedure</h4>
                            </div>
                            
                            <!-- Project Details -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Project Details</legend>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="swp-company">Company / General Contractor</label>
                                        <input type="text" id="swp-company" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="swp-date">Date</label>
                                        <input type="date" id="swp-date" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="swp-prepared-by">Prepared By</label>
                                        <input type="text" id="swp-prepared-by" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="swp-site-address">Site Address</label>
                                        <input type="text" id="swp-site-address" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="swp-site-superintendent">Site Superintendent</label>
                                        <input type="text" id="swp-site-superintendent" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="swp-supervisor-contact">Supervisor Contact</label>
                                        <input type="text" id="swp-supervisor-contact" required>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Job Details -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Job Details</legend>
                                
                                <!-- Tasks -->
                                <div style="margin-bottom: 15px;">
                                    <h5 style="color: #004080; margin-bottom: 10px;">Tasks</h5>
                                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 10px;" id="swp-tasks-table">
                                        <thead>
                                            <tr style="background-color: #eee;">
                                                <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Tasks</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td style="border: 1px solid #ccc; padding: 8px;">
                                                    <input type="text" id="swp-task-1" style="width: 100%; border: none; outline: none;">
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <button type="button" onclick="addSWPTask()" style="background: #004080; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Add Task</button>
                                </div>

                                <!-- Tools -->
                                <div style="margin-bottom: 15px;">
                                    <h5 style="color: #004080; margin-bottom: 10px;">Tools</h5>
                                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 10px;" id="swp-tools-table">
                                        <thead>
                                            <tr style="background-color: #eee;">
                                                <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Tools</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td style="border: 1px solid #ccc; padding: 8px;">
                                                    <input type="text" id="swp-tool-1" style="width: 100%; border: none; outline: none;">
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <button type="button" onclick="addSWPTool()" style="background: #004080; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Add Tool</button>
                                </div>

                                <!-- Procedures -->
                                <div style="margin-bottom: 15px;">
                                    <h5 style="color: #004080; margin-bottom: 10px;">Procedures</h5>
                                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 10px;" id="swp-procedures-table">
                                        <thead>
                                            <tr style="background-color: #eee;">
                                                <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Procedures</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td style="border: 1px solid #ccc; padding: 8px;">
                                                    <input type="text" id="swp-procedure-1" style="width: 100%; border: none; outline: none;">
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <button type="button" onclick="addSWPProcedure()" style="background: #004080; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Add Procedure</button>
                                </div>
                            </fieldset>

                            <!-- Documentation Required -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Documentation Required</legend>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 10px;">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-air-monitoring" name="swp-air-monitoring">
                                        <label for="swp-air-monitoring">Air Monitoring</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-respiratory-control" name="swp-respiratory-control">
                                        <label for="swp-respiratory-control">Respiratory Control Plan</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-worker-training" name="swp-worker-training">
                                        <label for="swp-worker-training">Worker Training</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-respiratory-fit-test" name="swp-respiratory-fit-test">
                                        <label for="swp-respiratory-fit-test">Respiratory Fit Test</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-written-silica" name="swp-written-silica">
                                        <label for="swp-written-silica">Written Silica Work Procedure</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-fall-protection-plan" name="swp-fall-protection-plan">
                                        <label for="swp-fall-protection-plan">Fall Protection Plan</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-confined-entry" name="swp-confined-entry">
                                        <label for="swp-confined-entry">Confined Entry</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-silica-ventilation" name="swp-silica-ventilation">
                                        <label for="swp-silica-ventilation">Silica Indoor Ventilation Plan</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-documentation-other" name="swp-documentation-other">
                                        <label for="swp-documentation-other">Other</label>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Controls -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Controls</legend>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 10px;">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-wet-work" name="swp-wet-work">
                                        <label for="swp-wet-work">Wet Work</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-controls-air-monitoring" name="swp-controls-air-monitoring">
                                        <label for="swp-controls-air-monitoring">Air Monitoring</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-coveralls" name="swp-coveralls">
                                        <label for="swp-coveralls">Coveralls</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-fall-protection" name="swp-fall-protection">
                                        <label for="swp-fall-protection">Fall Protection</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-isolation" name="swp-isolation">
                                        <label for="swp-isolation">Isolation</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-access-restricted" name="swp-access-restricted">
                                        <label for="swp-access-restricted">Access Restricted</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-gloves" name="swp-gloves">
                                        <label for="swp-gloves">Gloves</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-hearing-protection" name="swp-hearing-protection">
                                        <label for="swp-hearing-protection">Hearing Protection</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-ventilation" name="swp-ventilation">
                                        <label for="swp-ventilation">Ventilation</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-scheduling" name="swp-scheduling">
                                        <label for="swp-scheduling">Scheduling</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-reflective-vest" name="swp-reflective-vest">
                                        <label for="swp-reflective-vest">Reflective Vest</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-personal-fitted" name="swp-personal-fitted">
                                        <label for="swp-personal-fitted">Personal Fitted</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-vacuum" name="swp-vacuum">
                                        <label for="swp-vacuum">Vacuum</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-signage" name="swp-signage">
                                        <label for="swp-signage">Signage</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-eye-protection" name="swp-eye-protection">
                                        <label for="swp-eye-protection">Eye Protection</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-respirator" name="swp-respirator">
                                        <label for="swp-respirator">Respirator</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="swp-controls-other" name="swp-controls-other">
                                        <label for="swp-controls-other">Other</label>
                                    </div>
                                </div>
                            </fieldset>

                            <!-- Work Duration -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Work Duration</legend>
                                <div class="form-group">
                                    <label for="swp-work-duration">Work Duration (days/hours)</label>
                                    <input type="text" id="swp-work-duration" required>
                                </div>
                            </fieldset>

                            <!-- Workers On Site -->
                            <fieldset style="margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; background-color: #fff;">
                                <legend style="font-weight: bold; font-size: 1.1em; color: #004080;">Workers On Site</legend>
                                <table style="width: 100%; border-collapse: collapse; margin-bottom: 10px;" id="swp-workers-table">
                                    <thead>
                                        <tr style="background-color: #eee;">
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">#</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Name</th>
                                            <th style="border: 1px solid #ccc; padding: 8px; text-align: left;">Signature</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="border: 1px solid #ccc; padding: 8px;">1</td>
                                            <td style="border: 1px solid #ccc; padding: 8px;">
                                                <input type="text" id="swp-worker1-name" style="width: 100%; border: none; outline: none;">
                                            </td>
                                            <td style="border: 1px solid #ccc; padding: 8px;">
                                                <input type="text" id="swp-worker1-signature" style="width: 100%; border: none; outline: none;">
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button type="button" onclick="addSWPWorker()" style="background: #004080; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Add Worker</button>
                            </fieldset>
                        </div>
                    `;
                    break;
            }
            
            templateHTML += '</div>';
            contentDiv.innerHTML = templateHTML;
        }

        function saveDocument() {
            const docType = document.getElementById('document-type').value;
            
            if (!docType) {
                alert('Please select a document type!');
                return;
            }
            
            // Collect form data based on document type
            let formData = {};
            
            // Collect specific form data based on document type
            switch (docType) {
                case 'safety-checklist':
                    formData = {
                        crewMemberName: document.getElementById('crew-member-name')?.value || '',
                        jobSite: document.getElementById('job-site')?.value || '',
                        documentDate: document.getElementById('document-date')?.value || '',
                        ppeWorn: document.getElementById('safety-ppe')?.checked || false,
                        toolsGoodCondition: document.getElementById('safety-tools')?.checked || false,
                        areaClean: document.getElementById('safety-area')?.checked || false,
                        weatherSafe: document.getElementById('safety-weather')?.checked || false,
                        emergencyInfoAvailable: document.getElementById('safety-emergency')?.checked || false,
                        safetyNotes: document.getElementById('safety-notes')?.value || ''
                    };
                    break;
                    
                case 'work-order':
                    formData = {
                        crewMemberName: document.getElementById('crew-member-name')?.value || '',
                        jobSite: document.getElementById('job-site')?.value || '',
                        documentDate: document.getElementById('document-date')?.value || '',
                        workDescription: document.getElementById('work-description')?.value || '',
                        materialsUsed: document.getElementById('materials-used')?.value || '',
                        hoursWorked: document.getElementById('hours-worked')?.value || '',
                        workNotes: document.getElementById('work-notes')?.value || ''
                    };
                    break;
                    
                case 'incident-report':
                    formData = {
                        crewMemberName: document.getElementById('crew-member-name')?.value || '',
                        jobSite: document.getElementById('job-site')?.value || '',
                        documentDate: document.getElementById('document-date')?.value || '',
                        incidentTime: document.getElementById('incident-time')?.value || '',
                        severity: document.getElementById('incident-severity')?.value || '',
                        description: document.getElementById('incident-description')?.value || '',
                        actionsTaken: document.getElementById('incident-actions')?.value || ''
                    };
                    break;
                    
                case 'equipment-inspection':
                    formData = {
                        crewMemberName: document.getElementById('crew-member-name')?.value || '',
                        jobSite: document.getElementById('job-site')?.value || '',
                        documentDate: document.getElementById('document-date')?.value || '',
                        equipmentInspected: document.getElementById('equipment-list')?.value || '',
                        condition: document.getElementById('inspection-condition')?.value || '',
                        maintenanceNeeded: document.getElementById('maintenance-needed')?.value || '',
                        inspectionNotes: document.getElementById('inspection-notes')?.value || ''
                    };
                    break;
                    
                case 'time-sheet':
                    formData = {
                        crewMemberName: document.getElementById('crew-member-name')?.value || '',
                        jobSite: document.getElementById('job-site')?.value || '',
                        documentDate: document.getElementById('document-date')?.value || '',
                        startTime: document.getElementById('start-time')?.value || '',
                        endTime: document.getElementById('end-time')?.value || '',
                        breakTime: document.getElementById('break-time')?.value || '',
                        totalHours: document.getElementById('total-hours')?.value || '',
                        workActivities: document.getElementById('work-activities')?.value || ''
                    };
                    break;
                    
                case 'material-request':
                    formData = {
                        crewMemberName: document.getElementById('crew-member-name')?.value || '',
                        jobSite: document.getElementById('job-site')?.value || '',
                        documentDate: document.getElementById('document-date')?.value || '',
                        materialsNeeded: document.getElementById('materials-needed')?.value || '',
                        priority: document.getElementById('priority-level')?.value || '',
                        neededBy: document.getElementById('needed-by')?.value || '',
                        requestReason: document.getElementById('request-reason')?.value || ''
                    };
                    break;
                    
                case 'flha':
                    // Collect FLHA data using the inline function
                    formData = {
                        crewMemberName: document.getElementById('crew-member-name')?.value || '',
                        jobSite: document.getElementById('job-site')?.value || '',
                        documentDate: document.getElementById('document-date')?.value || '',
                        ...collectFLHAData()
                    };
                    break;
                    
                case 'daily-job-record':
                    formData = {
                        crewMemberName: document.getElementById('crew-member-name')?.value || '',
                        jobSite: document.getElementById('job-site')?.value || '',
                        documentDate: document.getElementById('document-date')?.value || '',
                        // Company Information
                        companyName: document.getElementById('djr-company-name')?.value || '',
                        poNumber: document.getElementById('djr-po-number')?.value || '',
                        date: document.getElementById('djr-date')?.value || '',
                        companyAddress: document.getElementById('djr-company-address')?.value || '',
                        projectName: document.getElementById('djr-project-name')?.value || '',
                        workOrderedBy: document.getElementById('djr-work-ordered-by')?.value || '',
                        projectAddress: document.getElementById('djr-project-address')?.value || '',
                        phone: document.getElementById('djr-phone')?.value || '',
                        email: document.getElementById('djr-email')?.value || '',
                        siteContact: document.getElementById('djr-site-contact')?.value || '',
                        call: document.getElementById('djr-call')?.value || '',
                        // Work Description
                        workDescription: document.getElementById('djr-work-description')?.value || '',
                        // Services & Tool Hours
                        slabSawing: document.getElementById('djr-slab-sawing')?.value || '',
                        wallSawing: document.getElementById('djr-wall-sawing')?.value || '',
                        wireSawing: document.getElementById('djr-wire-sawing')?.value || '',
                        coreDrilling: document.getElementById('djr-core-drilling')?.value || '',
                        hicycleDrilling: document.getElementById('djr-hicycle-drilling')?.value || '',
                        handSawing: document.getElementById('djr-hand-sawing')?.value || '',
                        excavator: document.getElementById('djr-excavator')?.value || '',
                        skidSteer: document.getElementById('djr-skid-steer')?.value || '',
                        demolitionRobot: document.getElementById('djr-demolition-robot')?.value || '',
                        jackhammer: document.getElementById('djr-jackhammer')?.value || '',
                        foreman: document.getElementById('djr-foreman')?.value || '',
                        labour: document.getElementById('djr-labour')?.value || '',
                        other: document.getElementById('djr-other')?.value || '',
                        // Site Resources
                        slurryBarrels: document.getElementById('djr-slurry-barrels')?.value || '',
                        generator: document.getElementById('djr-generator')?.value || '',
                        pigtail: document.getElementById('djr-pigtail')?.value || '',
                        bins: document.getElementById('djr-bins')?.value || '',
                        equipmentLeft: document.getElementById('djr-equipment-left')?.value || '',
                        jobComplete: document.getElementById('djr-job-complete')?.value || '',
                        // Employee Time Log
                        emp1Name: document.getElementById('djr-emp1-name')?.value || '',
                        emp1Regular: document.getElementById('djr-emp1-regular')?.value || '',
                        emp1OT: document.getElementById('djr-emp1-ot')?.value || '',
                        emp1DT: document.getElementById('djr-emp1-dt')?.value || '',
                        emp1Gear: document.getElementById('djr-emp1-gear')?.value || '',
                        emp1Travel: document.getElementById('djr-emp1-travel')?.value || '',
                        emp1Shop: document.getElementById('djr-emp1-shop')?.value || '',
                        emp1Total: document.getElementById('djr-emp1-total')?.value || '',
                        emp2Name: document.getElementById('djr-emp2-name')?.value || '',
                        emp2Regular: document.getElementById('djr-emp2-regular')?.value || '',
                        emp2OT: document.getElementById('djr-emp2-ot')?.value || '',
                        emp2DT: document.getElementById('djr-emp2-dt')?.value || '',
                        emp2Gear: document.getElementById('djr-emp2-gear')?.value || '',
                        emp2Travel: document.getElementById('djr-emp2-travel')?.value || '',
                        emp2Shop: document.getElementById('djr-emp2-shop')?.value || '',
                        emp2Total: document.getElementById('djr-emp2-total')?.value || '',
                        emp3Name: document.getElementById('djr-emp3-name')?.value || '',
                        emp3Regular: document.getElementById('djr-emp3-regular')?.value || '',
                        emp3OT: document.getElementById('djr-emp3-ot')?.value || '',
                        emp3DT: document.getElementById('djr-emp3-dt')?.value || '',
                        emp3Gear: document.getElementById('djr-emp3-gear')?.value || '',
                        emp3Travel: document.getElementById('djr-emp3-travel')?.value || '',
                        emp3Shop: document.getElementById('djr-emp3-shop')?.value || '',
                        emp3Total: document.getElementById('djr-emp3-total')?.value || '',
                        emp4Name: document.getElementById('djr-emp4-name')?.value || '',
                        emp4Regular: document.getElementById('djr-emp4-regular')?.value || '',
                        emp4OT: document.getElementById('djr-emp4-ot')?.value || '',
                        emp4DT: document.getElementById('djr-emp4-dt')?.value || '',
                        emp4Gear: document.getElementById('djr-emp4-gear')?.value || '',
                        emp4Travel: document.getElementById('djr-emp4-travel')?.value || '',
                        emp4Shop: document.getElementById('djr-emp4-shop')?.value || '',
                        emp4Total: document.getElementById('djr-emp4-total')?.value || '',
                        emp5Name: document.getElementById('djr-emp5-name')?.value || '',
                        emp5Regular: document.getElementById('djr-emp5-regular')?.value || '',
                        emp5OT: document.getElementById('djr-emp5-ot')?.value || '',
                        emp5DT: document.getElementById('djr-emp5-dt')?.value || '',
                        emp5Gear: document.getElementById('djr-emp5-gear')?.value || '',
                        emp5Travel: document.getElementById('djr-emp5-travel')?.value || '',
                        emp5Shop: document.getElementById('djr-emp5-shop')?.value || '',
                        emp5Total: document.getElementById('djr-emp5-total')?.value || '',
                        // Standby
                        standbyStart: document.getElementById('djr-standby-start')?.value || '',
                        standbyFinish: document.getElementById('djr-standby-finish')?.value || '',
                        standbyHours: document.getElementById('djr-standby-hours')?.value || '',
                        standbyReason: document.getElementById('djr-standby-reason')?.value || '',
                        // Signatures
                        operatorSignature: document.getElementById('djr-operator-signature')?.value || '',
                        customerSignature: document.getElementById('djr-customer-signature')?.value || '',
                        // Comments
                        comments: document.getElementById('djr-comments')?.value || ''
                    };
                    break;
                    
                case 'silica-exposure-plan':
                    formData = {
                        crewMemberName: document.getElementById('crew-member-name')?.value || '',
                        jobSite: document.getElementById('job-site')?.value || '',
                        documentDate: document.getElementById('document-date')?.value || '',
                        // General Info
                        dateCompleted: document.getElementById('sep-date-completed')?.value || '',
                        preparedBy: document.getElementById('sep-prepared-by')?.value || '',
                        company: document.getElementById('sep-company')?.value || '',
                        superintendent: document.getElementById('sep-superintendent')?.value || '',
                        supervisor: document.getElementById('sep-supervisor')?.value || '',
                        workDuration: document.getElementById('sep-work-duration')?.value || '',
                        // Job Details
                        tasks: collectSEPTasks(),
                        controls: collectSEPControls(),
                        tools: collectSEPTools(),
                        // Respirator & PPE
                        respiratorType: document.getElementById('sep-respirator-type')?.value || '',
                        ppe: document.getElementById('sep-ppe')?.value || '',
                        // Procedures & Hazards
                        housekeeping: document.getElementById('sep-housekeeping')?.value || '',
                        otherHazards: document.getElementById('sep-other-hazards')?.value || '',
                        // Other Required Documents
                        airMonitoring: document.getElementById('sep-air-monitoring')?.checked || false,
                        writtenSilica: document.getElementById('sep-written-silica')?.checked || false,
                        respiratoryFitTest: document.getElementById('sep-respiratory-fit-test')?.checked || false,
                        silicaVentilation: document.getElementById('sep-silica-ventilation')?.checked || false,
                        confinedEntry: document.getElementById('sep-confined-entry')?.checked || false,
                        workerTraining: document.getElementById('sep-worker-training')?.checked || false,
                        respiratoryControl: document.getElementById('sep-respiratory-control')?.checked || false,
                        fallProtectionPlan: document.getElementById('sep-fall-protection-plan')?.checked || false,
                        documentsOther: document.getElementById('sep-documents-other')?.checked || false,
                        documentsOtherSpecify: document.getElementById('sep-documents-other-specify')?.value || '',
                        // Other Controls
                        wetWork: document.getElementById('sep-wet-work')?.checked || false,
                        controlsAirMonitoring: document.getElementById('sep-controls-air-monitoring')?.checked || false,
                        coveralls: document.getElementById('sep-coveralls')?.checked || false,
                        fallProtection: document.getElementById('sep-fall-protection')?.checked || false,
                        isolation: document.getElementById('sep-isolation')?.checked || false,
                        accessRestricted: document.getElementById('sep-access-restricted')?.checked || false,
                        gloves: document.getElementById('sep-gloves')?.checked || false,
                        hearingProtection: document.getElementById('sep-hearing-protection')?.checked || false,
                        ventilation: document.getElementById('sep-ventilation')?.checked || false,
                        scheduling: document.getElementById('sep-scheduling')?.checked || false,
                        reflectiveVest: document.getElementById('sep-reflective-vest')?.checked || false,
                        personalFitted: document.getElementById('sep-personal-fitted')?.checked || false,
                        vacuum: document.getElementById('sep-vacuum')?.checked || false,
                        signage: document.getElementById('sep-signage')?.checked || false,
                        eyeProtection: document.getElementById('sep-eye-protection')?.checked || false,
                        respirator: document.getElementById('sep-respirator')?.checked || false,
                        controlsOther: document.getElementById('sep-controls-other')?.checked || false,
                        controlsOtherSpecify: document.getElementById('sep-controls-other-specify')?.value || '',
                        // Workers On Site
                        workers: collectSEPWorkers()
                    };
                    break;
                    
                case 'safe-work-procedure':
                    formData = {
                        crewMemberName: document.getElementById('crew-member-name')?.value || '',
                        jobSite: document.getElementById('job-site')?.value || '',
                        documentDate: document.getElementById('document-date')?.value || '',
                        // Project Details
                        company: document.getElementById('swp-company')?.value || '',
                        date: document.getElementById('swp-date')?.value || '',
                        preparedBy: document.getElementById('swp-prepared-by')?.value || '',
                        siteAddress: document.getElementById('swp-site-address')?.value || '',
                        siteSuperintendent: document.getElementById('swp-site-superintendent')?.value || '',
                        supervisorContact: document.getElementById('swp-supervisor-contact')?.value || '',
                        // Job Details - Tasks
                        tasks: collectSWPTasks(),
                        // Job Details - Tools
                        tools: collectSWPTools(),
                        // Job Details - Procedures
                        procedures: collectSWPProcedures(),
                        // Documentation Required
                        airMonitoring: document.getElementById('swp-air-monitoring')?.checked || false,
                        respiratoryControl: document.getElementById('swp-respiratory-control')?.checked || false,
                        workerTraining: document.getElementById('swp-worker-training')?.checked || false,
                        respiratoryFitTest: document.getElementById('swp-respiratory-fit-test')?.checked || false,
                        writtenSilica: document.getElementById('swp-written-silica')?.checked || false,
                        fallProtectionPlan: document.getElementById('swp-fall-protection-plan')?.checked || false,
                        confinedEntry: document.getElementById('swp-confined-entry')?.checked || false,
                        silicaVentilation: document.getElementById('swp-silica-ventilation')?.checked || false,
                        documentationOther: document.getElementById('swp-documentation-other')?.checked || false,
                        // Controls
                        wetWork: document.getElementById('swp-wet-work')?.checked || false,
                        controlsAirMonitoring: document.getElementById('swp-controls-air-monitoring')?.checked || false,
                        coveralls: document.getElementById('swp-coveralls')?.checked || false,
                        fallProtection: document.getElementById('swp-fall-protection')?.checked || false,
                        isolation: document.getElementById('swp-isolation')?.checked || false,
                        accessRestricted: document.getElementById('swp-access-restricted')?.checked || false,
                        gloves: document.getElementById('swp-gloves')?.checked || false,
                        hearingProtection: document.getElementById('swp-hearing-protection')?.checked || false,
                        ventilation: document.getElementById('swp-ventilation')?.checked || false,
                        scheduling: document.getElementById('swp-scheduling')?.checked || false,
                        reflectiveVest: document.getElementById('swp-reflective-vest')?.checked || false,
                        personalFitted: document.getElementById('swp-personal-fitted')?.checked || false,
                        vacuum: document.getElementById('swp-vacuum')?.checked || false,
                        signage: document.getElementById('swp-signage')?.checked || false,
                        eyeProtection: document.getElementById('swp-eye-protection')?.checked || false,
                        respirator: document.getElementById('swp-respirator')?.checked || false,
                        controlsOther: document.getElementById('swp-controls-other')?.checked || false,
                        // Work Duration
                        workDuration: document.getElementById('swp-work-duration')?.value || '',
                        // Workers On Site
                        workers: collectSWPWorkers()
                    };
                    break;
            }
            
            // Check if this is a new document or updating existing
            const docId = parseInt(document.getElementById('document-form').dataset.documentId);
            
            if (docId) {
                // Update existing document
                const docIndex = AppData.documents.findIndex(d => d.id === docId);
                if (docIndex !== -1) {
                    AppData.documents[docIndex] = {
                        ...AppData.documents[docIndex],
                        status: 'completed',
                        completedAt: new Date().toISOString(),
                        data: formData
                    };
                    
                    saveToStorage(STORAGE_KEYS.DOCUMENTS, AppData.documents);
                    console.log(`✅ Document ${docId} completed and saved`);
                    
                    hideDocumentFormModal();
                    loadCrewDocumentsTab(); // Refresh the documents tab
                    
                    alert('Document saved successfully!');
                } else {
                    alert('Document not found!');
                }
            } else {
                // Create new document
                const newDocId = AppData.documents.length > 0 ? Math.max(...AppData.documents.map(d => d.id)) + 1 : 1;
                const newDocument = {
                    id: newDocId,
                    type: docType,
                    title: `${docType.charAt(0).toUpperCase() + docType.slice(1).replace('-', ' ')} - ${new Date().toLocaleDateString()}`,
                    description: `Document created on ${new Date().toLocaleDateString()}`,
                    category: 'other',
                    status: 'completed',
                    dueDate: new Date().toISOString().split('T')[0],
                    assignedCrew: AppData.currentUser.crewName,
                    createdAt: new Date().toISOString(),
                    completedAt: new Date().toISOString(),
                    data: formData
                };
                
                AppData.documents.push(newDocument);
                saveToStorage(STORAGE_KEYS.DOCUMENTS, AppData.documents);
                console.log(`✅ New document ${newDocId} created and saved`);
                
                hideDocumentFormModal();
                loadCrewDocumentsTab(); // Refresh the documents tab
                
                alert('New document created and saved successfully!');
            }
        }

        function exportDocumentToPDF() {
            const docType = document.getElementById('document-type').value;
            
            if (!docType) {
                alert('Please select a document type before exporting to PDF!');
                return;
            }
            
            // Find the actual form content
            let formContent = null;
            
            // Get the document content div which contains the actual form
            const documentContent = document.getElementById('document-content');
            if (documentContent) {
                formContent = documentContent.cloneNode(true);
            }
            
            if (!formContent) {
                alert('Could not find document content to export!');
                return;
            }
            
            // Create a temporary container for PDF generation
            const pdfContainer = document.createElement('div');
            pdfContainer.style.position = 'absolute';
            pdfContainer.style.left = '-9999px';
            pdfContainer.style.top = '0';
            pdfContainer.style.width = '800px';
            pdfContainer.style.backgroundColor = 'white';
            pdfContainer.style.padding = '20px';
            pdfContainer.style.fontFamily = 'Arial, sans-serif';
            pdfContainer.style.fontSize = '12px';
            pdfContainer.style.lineHeight = '1.4';
            
            // Add header
            const header = document.createElement('div');
            header.innerHTML = `
                <div style="text-align: center; margin-bottom: 30px;">
                    <div style="display: flex; flex-direction: column; align-items: center; margin-bottom: 20px;">
                        <div style="width: 200px; height: 8px; background: linear-gradient(90deg, #4a90e2 0%, #5a4fcf 100%); border-radius: 4px; margin-bottom: 8px;"></div>
                        <div style="text-align: center; line-height: 1.2;">
                            <div style="font-size: 2.5rem; font-weight: bold; color: #1e3a8a; margin: 0; letter-spacing: 2px;">BROTHERS</div>
                            <div style="width: 120px; height: 2px; background: #000; margin: 8px auto;"></div>
                            <div style="font-size: 1.2rem; font-weight: bold; color: #1e3a8a; margin: 0; letter-spacing: 1px;">CUTTING & CORING LTD.</div>
                        </div>
                    </div>
                    <h2 style="color: #667eea; margin-bottom: 20px;">${getDocumentTypeTitle(docType)}</h2>
                    <div style="border-bottom: 2px solid #667eea; margin-bottom: 20px;"></div>
                </div>
            `;
            pdfContainer.appendChild(header);
            
            // Add the actual form content
            pdfContainer.appendChild(formContent);
            
            // Add footer
            const footer = document.createElement('div');
            footer.innerHTML = `
                <div style="margin-top: 40px; text-align: center; border-top: 1px solid #ddd; padding-top: 20px;">
                    <p style="color: #666; font-size: 10px;">
                        Generated on ${new Date().toLocaleString()} | Brothers Cutting & Coring Document System
                    </p>
                </div>
            `;
            pdfContainer.appendChild(footer);
            
            // Add to DOM temporarily
            document.body.appendChild(pdfContainer);
            
            // Generate PDF
            html2canvas(pdfContainer, {
                scale: 2,
                useCORS: true,
                allowTaint: true,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new window.jsPDF('p', 'mm', 'a4');
                const imgWidth = 210;
                const pageHeight = 295;
                const imgHeight = canvas.height * imgWidth / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                // Generate filename
                const timestamp = new Date().toISOString().slice(0, 10);
                const filename = `${docType}_${timestamp}.pdf`;
                
                // Download PDF
                pdf.save(filename);
                
                // Clean up
                document.body.removeChild(pdfContainer);
                
                alert('PDF exported successfully!');
            }).catch(error => {
                console.error('Error generating PDF:', error);
                alert('Error generating PDF. Please try again.');
                document.body.removeChild(pdfContainer);
            });
        }
        
        function generateDocumentContent(docType) {
            let content = `
                <div style="text-align: center; margin-bottom: 30px;">
                    <div style="display: flex; flex-direction: column; align-items: center; margin-bottom: 20px;">
                        <div style="width: 200px; height: 8px; background: linear-gradient(90deg, #4a90e2 0%, #5a4fcf 100%); border-radius: 4px; margin-bottom: 8px;"></div>
                        <div style="text-align: center; line-height: 1.2;">
                            <div style="font-size: 2.5rem; font-weight: bold; color: #1e3a8a; margin: 0; letter-spacing: 2px;">BROTHERS</div>
                            <div style="width: 120px; height: 2px; background: #000; margin: 8px auto;"></div>
                            <div style="font-size: 1.2rem; font-weight: bold; color: #1e3a8a; margin: 0; letter-spacing: 1px;">CUTTING & CORING LTD.</div>
                        </div>
                    </div>
                    <h2 style="color: #667eea; margin-bottom: 20px;">${getDocumentTypeTitle(docType)}</h2>
                    <div style="border-bottom: 2px solid #667eea; margin-bottom: 20px;"></div>
                </div>
            `;
            
            // Add specific content based on document type
            switch (docType) {
                case 'flha':
                    content += generateFLHAPDFContent();
                    break;
                case 'daily-job-record':
                    content += generateDailyJobRecordPDFContent();
                    break;
                case 'safe-work-procedure':
                    content += generateSafeWorkProcedurePDFContent();
                    break;
                case 'silica-exposure-plan':
                    content += generateSilicaExposurePlanPDFContent();
                    break;
                case 'safety-checklist':
                    content += generateSafetyChecklistPDFContent();
                    break;
                case 'work-order':
                    content += generateWorkOrderPDFContent();
                    break;
                case 'incident-report':
                    content += generateIncidentReportPDFContent();
                    break;
                case 'equipment-inspection':
                    content += generateEquipmentInspectionPDFContent();
                    break;
                case 'time-sheet':
                    content += generateTimeSheetPDFContent();
                    break;
                case 'material-request':
                    content += generateMaterialRequestPDFContent();
                    break;
                default:
                    content += '<p>Document content will be displayed here.</p>';
            }
            
            // Add footer
            content += `
                <div style="margin-top: 40px; text-align: center; border-top: 1px solid #ddd; padding-top: 20px;">
                    <p style="color: #666; font-size: 10px;">
                        Generated on ${new Date().toLocaleString()} | Schedule Pro Document System
                    </p>
                </div>
            `;
            
            return content;
        }
        
        function getDocumentTypeTitle(docType) {
            const titles = {
                'flha': 'Field Level Hazard Assessment (FLHA)',
                'daily-job-record': 'Daily Job Record (DJR)',
                'safe-work-procedure': 'Safe Work Procedure (SWP)',
                'silica-exposure-plan': 'Silica Exposure Plan',
                'safety-checklist': 'Safety Checklist',
                'work-order': 'Work Order',
                'incident-report': 'Incident Report',
                'equipment-inspection': 'Equipment Inspection',
                'time-sheet': 'Time Sheet',
                'material-request': 'Material Request'
            };
            return titles[docType] || 'Document';
        }
        
        function generateFLHAPDFContent() {
            const flhaData = collectFLHAData();
            let content = '<h3 style="color: #333; margin-bottom: 15px;">Field Level Hazard Assessment (FLHA)</h3>';
            
            // Document Information
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Document Information</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Date:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('document-date')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Crew Member:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('crew-member-name')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Job Site:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('job-site')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
            `;
            
            // Project Information
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Project Information</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Project Name:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.projectName || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Project Number:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.projectNumber || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Work Location:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.workLocation || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Work Date:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.workDate || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
            `;
            
            // Work Activities
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Work Activities</h4>
                    <p style="margin-bottom: 10px;"><strong>Description of Work:</strong> ${flhaData.workDescription || 'N/A'}</p>
                    <p style="margin-bottom: 10px;"><strong>Equipment/Tools:</strong> ${flhaData.equipmentTools || 'N/A'}</p>
                </div>
            `;
            
            // Hazard Assessment
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Hazard Assessment</h4>
                    <p style="margin-bottom: 10px;"><strong>Identified Hazards:</strong> ${flhaData.identifiedHazards || 'N/A'}</p>
                    <p style="margin-bottom: 10px;"><strong>Risk Level:</strong> ${flhaData.riskLevel || 'N/A'}</p>
                    <p style="margin-bottom: 10px;"><strong>Control Measures:</strong> ${flhaData.controlMeasures || 'N/A'}</p>
                </div>
            `;
            
            // Job Steps and Hazards Table
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Job Steps and Hazards</h4>
                    <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;">
                        <thead>
                            <tr style="background-color: #f8f9fa;">
                                <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Job Step</th>
                                <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Hazard</th>
                                <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Control</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            // Get dynamic table data
            const hazardTable = document.getElementById('hazard-rows')?.querySelector('tbody');
            if (hazardTable && hazardTable.rows.length > 0) {
                for (let i = 0; i < hazardTable.rows.length; i++) {
                    const row = hazardTable.rows[i];
                    const inputs = row.querySelectorAll('input');
                    const jobStep = inputs[0]?.value || '';
                    const hazard = inputs[1]?.value || '';
                    const control = inputs[2]?.value || '';
                    
                    if (jobStep || hazard || control) {
                        content += `
                            <tr>
                                <td style="padding: 8px; border: 1px solid #ddd;">${jobStep}</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">${hazard}</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">${control}</td>
                            </tr>
                        `;
                    }
                }
            } else {
                content += `
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;" colspan="3">No job steps entered</td>
                    </tr>
                `;
            }
            
            content += `
                        </tbody>
                    </table>
                </div>
            `;
            
            // Safety Checks
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Safety Checks</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">PPE Required:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.ppeRequired ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Safety Meeting Completed:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.safetyMeetingCompleted ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Emergency Procedures Reviewed:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.emergencyProceduresReviewed ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Equipment Inspected:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.equipmentInspected ? 'Yes' : 'No'}</td>
                        </tr>
                    </table>
                </div>
            `;
            
            // Work at Heights
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Work at Heights</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Scaffolding:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.scaffolding ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Ladders:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.ladders ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Man Basket:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.manbasket ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Aerial Lift:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.aerialLift ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Other Heights:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.otherHeights ? 'Yes' : 'No'}</td>
                        </tr>
                    </table>
                </div>
            `;
            
            // Emergency Plan / Equipment
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Emergency Plan / Equipment</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Emergency Plan:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.emergencyPlan ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Communication:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.communication ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">CSO Identified:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.csoIdentified ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Eye Wash:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.eyeWash ? 'Yes' : 'No'}</td>
                        </tr>
                    </table>
                </div>
            `;
            
            // Protective Equipment
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Protective Equipment</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Respiratory Protection:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.respiratoryProtection ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Hardhat Protection:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.hardhatProtection ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">PFD:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.pfd ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Goggles:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.goggles ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Gloves:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.gloves ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Coveralls:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.coveralls ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Hearing Protection:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.hearingProtection ? 'Yes' : 'No'}</td>
                        </tr>
                    </table>
                </div>
            `;
            
            // Environmental Assessment
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Environmental Assessment</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Spill Response:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.spillResponse ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Lighting Levels:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.lightingLevels ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Refueling Equipment:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.refuelingEquipment ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Erosion/Sediment:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.erosionSediment ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Wildlife:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.wildlife ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Heat/Cold:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.heatCold ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Silica Exposure:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.silicaExposure ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Weather/Wind:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.weatherWind ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Tide/Current:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.tideCurrent ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Waste Material:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.wasteMaterial ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Weld Fumes:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.weldFumes ? 'Yes' : 'No'}</td>
                        </tr>
                    </table>
                </div>
            `;
            
            // Limitations / Hazards
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Limitations / Hazards</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Procedure Not Available:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.procedureNotAvailable ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Confusing Instructions:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.confusingInstructions ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">No Training Task:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.noTrainingTask ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">No Training Tools:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.noTrainingTools ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">First Time Task:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.firstTimeTask ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">New Worker:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.newWorker ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Physically Prepared:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.physicallyPrepared ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Awkward Load:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.awkwardLoad ? 'Yes' : 'No'}</td>
                        </tr>
                    </table>
                </div>
            `;
            
            // Access / Egress
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Access / Egress</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Scaffolding Approved:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.scaffoldingApproved ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Ladder Secured:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.ladderSecured ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Confined Space Entry:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.confinedSpaceEntry ? 'Yes' : 'No'}</td>
                        </tr>
                    </table>
                </div>
            `;
            
            // Other Hazards
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Other Hazards</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">WHMIS/SDS:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.whmisSds ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Electrical Cords:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.electricalCords ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Spotters Cranes:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.spottersCranes ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Rigging Certificates:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.riggingCertificates ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Hot Work Firewatch:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.hotWorkFirewatch ? 'Yes' : 'No'}</td>
                        </tr>
                    </table>
                </div>
            `;
            
            // Personnel Acknowledgement
            if (flhaData.foremanSignature || flhaData.superintendentSignature) {
                content += `
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #667eea; margin-bottom: 10px;">Personnel Acknowledgement</h4>
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr>
                                <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Foreman Signature:</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.foremanSignature || 'N/A'}</td>
                                <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 20%;">Date:</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.foremanDate || 'N/A'}</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Superintendent Signature:</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.superintendentSignature || 'N/A'}</td>
                                <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Date:</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.superintendentDate || 'N/A'}</td>
                            </tr>
                        </table>
                    </div>
                `;
            }
            
            // Crew Signatures Table
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Crew Signatures</h4>
                    <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;">
                        <thead>
                            <tr style="background-color: #f8f9fa;">
                                <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">#</th>
                                <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Name</th>
                                <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Signature</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            // Get dynamic signature table data
            const signatureTable = document.getElementById('crew-signatures')?.querySelector('tbody');
            if (signatureTable && signatureTable.rows.length > 0) {
                for (let i = 0; i < signatureTable.rows.length; i++) {
                    const row = signatureTable.rows[i];
                    const inputs = row.querySelectorAll('input');
                    const name = inputs[1]?.value || '';
                    const signature = inputs[2]?.value || '';
                    
                    if (name || signature) {
                        content += `
                            <tr>
                                <td style="padding: 8px; border: 1px solid #ddd;">${i + 1}</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">${name}</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">${signature}</td>
                            </tr>
                        `;
                    }
                }
            } else {
                content += `
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;" colspan="3">No crew signatures entered</td>
                    </tr>
                `;
            }
            
            content += `
                        </tbody>
                    </table>
                </div>
            `;
            
            // End-of-Shift Review
            content += `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">End-of-Shift Review</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Incidents Occurred:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.incidentsYes ? 'Yes' : flhaData.incidentsNo ? 'No' : 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Incident Details:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.incidentsWho || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Incident Reported:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.reportedYes ? 'Yes' : flhaData.reportedNo ? 'No' : 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Reported To:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.reportedTo || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Area Cleaned:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.cleanedYes ? 'Yes' : flhaData.cleanedNo ? 'No' : 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Concerns:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${flhaData.concerns || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
            `;
            
            return content;
        }
        
        function generateDailyJobRecordPDFContent() {
            return `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Document Information</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Date:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('document-date')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Crew Member:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('crew-member-name')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Job Site:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('job-site')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Company Information</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Company Name:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('djr-company-name')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">PO Number:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('djr-po-number')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Project Name:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('djr-project-name')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Site Contact:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('djr-site-contact')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Work Description</h4>
                    <p style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9; margin: 0;">${document.getElementById('djr-work-description')?.value || 'N/A'}</p>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Services & Tool Hours</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr style="background-color: #f5f5f5;">
                            <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Service</th>
                            <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Hours</th>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd;">Slab Sawing</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('djr-slab-sawing')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd;">Wall Sawing</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('djr-wall-sawing')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd;">Core Drilling</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('djr-core-drilling')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd;">Foreman</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('djr-foreman')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd;">Labour</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('djr-labour')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Job Status</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Equipment Left on Site:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('djr-equipment-left')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Job Complete:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('djr-job-complete')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Comments</h4>
                    <p style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9; margin: 0;">${document.getElementById('djr-comments')?.value || 'N/A'}</p>
                </div>
            `;
        }
        
        function generateSafeWorkProcedurePDFContent() {
            return `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Document Information</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Date:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('document-date')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Crew Member:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('crew-member-name')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Job Site:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('job-site')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Project Details</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Company / General Contractor:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('swp-company')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Date:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('swp-date')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Prepared By:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('swp-prepared-by')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Site Address:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('swp-site-address')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Site Superintendent:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('swp-site-superintendent')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Supervisor Contact:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('swp-supervisor-contact')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Job Details</h4>
                    <div style="margin-bottom: 15px;">
                        <h5 style="color: #333; margin-bottom: 8px;">Tasks</h5>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            ${collectSWPTasks().map(task => `<div style="margin-bottom: 5px;">• ${task}</div>`).join('') || 'No tasks specified'}
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <h5 style="color: #333; margin-bottom: 8px;">Tools</h5>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            ${collectSWPTools().map(tool => `<div style="margin-bottom: 5px;">• ${tool}</div>`).join('') || 'No tools specified'}
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <h5 style="color: #333; margin-bottom: 8px;">Procedures</h5>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            ${collectSWPProcedures().map(procedure => `<div style="margin-bottom: 5px;">• ${procedure}</div>`).join('') || 'No procedures specified'}
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Documentation Required</h4>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Air Monitoring:</strong> ${document.getElementById('swp-air-monitoring')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Respiratory Control Plan:</strong> ${document.getElementById('swp-respiratory-control')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Worker Training:</strong> ${document.getElementById('swp-worker-training')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Fall Protection Plan:</strong> ${document.getElementById('swp-fall-protection-plan')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Confined Entry:</strong> ${document.getElementById('swp-confined-entry')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Other:</strong> ${document.getElementById('swp-documentation-other')?.checked ? 'Yes' : 'No'}
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Controls</h4>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Wet Work:</strong> ${document.getElementById('swp-wet-work')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Fall Protection:</strong> ${document.getElementById('swp-fall-protection')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Gloves:</strong> ${document.getElementById('swp-gloves')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Eye Protection:</strong> ${document.getElementById('swp-eye-protection')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Respirator:</strong> ${document.getElementById('swp-respirator')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Other:</strong> ${document.getElementById('swp-controls-other')?.checked ? 'Yes' : 'No'}
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Work Duration</h4>
                    <p style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9; margin: 0;">${document.getElementById('swp-work-duration')?.value || 'N/A'}</p>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Workers On Site</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr style="background-color: #f5f5f5;">
                            <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">#</th>
                            <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Name</th>
                            <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Signature</th>
                        </tr>
                        ${collectSWPWorkers().map(worker => `
                            <tr>
                                <td style="padding: 8px; border: 1px solid #ddd;">${worker.number}</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">${worker.name}</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">${worker.signature}</td>
                            </tr>
                        `).join('') || '<tr><td colspan="3" style="padding: 8px; border: 1px solid #ddd; text-align: center;">No workers specified</td></tr>'}
                    </table>
                </div>
            `;
        }
        
        function generateSilicaExposurePlanPDFContent() {
            return `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Document Information</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Date:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('document-date')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Crew Member:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('crew-member-name')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Job Site:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('job-site')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">General Info</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Date Plan Completed:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('sep-date-completed')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Prepared By:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('sep-prepared-by')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Company:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('sep-company')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Superintendent:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('sep-superintendent')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Supervisor:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('sep-supervisor')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Work Duration:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('sep-work-duration')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Job Details</h4>
                    <div style="margin-bottom: 15px;">
                        <h5 style="color: #333; margin-bottom: 8px;">Tasks</h5>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            ${collectSEPTasks().map(task => `<div style="margin-bottom: 5px;">• ${task}</div>`).join('') || 'No tasks specified'}
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <h5 style="color: #333; margin-bottom: 8px;">Controls</h5>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            ${collectSEPControls().map(control => `<div style="margin-bottom: 5px;">• ${control}</div>`).join('') || 'No controls specified'}
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <h5 style="color: #333; margin-bottom: 8px;">Tools</h5>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            ${collectSEPTools().map(tool => `<div style="margin-bottom: 5px;">• ${tool}</div>`).join('') || 'No tools specified'}
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Respirator & PPE</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Respirator Type:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('sep-respirator-type')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Personal Protective Equipment:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('sep-ppe')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Procedures & Hazards</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Housekeeping / Disposal Procedures:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('sep-housekeeping')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Other Hazards:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('sep-other-hazards')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Other Required Documents</h4>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Air Monitoring:</strong> ${document.getElementById('sep-air-monitoring')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Written Silica Work Procedure:</strong> ${document.getElementById('sep-written-silica')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Respiratory Fit Test:</strong> ${document.getElementById('sep-respiratory-fit-test')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Silica Indoor Ventilation Plan:</strong> ${document.getElementById('sep-silica-ventilation')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Confined Entry:</strong> ${document.getElementById('sep-confined-entry')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Worker Training:</strong> ${document.getElementById('sep-worker-training')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Respiratory Control Plan:</strong> ${document.getElementById('sep-respiratory-control')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Fall Protection Plan:</strong> ${document.getElementById('sep-fall-protection-plan')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Other:</strong> ${document.getElementById('sep-documents-other')?.checked ? (document.getElementById('sep-documents-other-specify')?.value || 'Yes') : 'No'}
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Other Controls</h4>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Wet Work:</strong> ${document.getElementById('sep-wet-work')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Air Monitoring:</strong> ${document.getElementById('sep-controls-air-monitoring')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Coveralls:</strong> ${document.getElementById('sep-coveralls')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Fall Protection:</strong> ${document.getElementById('sep-fall-protection')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Gloves:</strong> ${document.getElementById('sep-gloves')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Eye Protection:</strong> ${document.getElementById('sep-eye-protection')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Respirator:</strong> ${document.getElementById('sep-respirator')?.checked ? 'Yes' : 'No'}
                        </div>
                        <div style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;">
                            <strong>Other:</strong> ${document.getElementById('sep-controls-other')?.checked ? (document.getElementById('sep-controls-other-specify')?.value || 'Yes') : 'No'}
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Workers On Site</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr style="background-color: #f5f5f5;">
                            <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">#</th>
                            <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Name</th>
                            <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Signature</th>
                        </tr>
                        ${collectSEPWorkers().map(worker => `
                            <tr>
                                <td style="padding: 8px; border: 1px solid #ddd;">${worker.number}</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">${worker.name}</td>
                                <td style="padding: 8px; border: 1px solid #ddd;">${worker.signature}</td>
                            </tr>
                        `).join('') || '<tr><td colspan="3" style="padding: 8px; border: 1px solid #ddd; text-align: center;">No workers specified</td></tr>'}
                    </table>
                </div>
            `;
        }
        
        function generateSafetyChecklistPDFContent() {
            return `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Document Information</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Date:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('document-date')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Crew Member:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('crew-member-name')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Job Site:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('job-site')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Safety Checklist</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">PPE Worn:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('safety-ppe')?.checked ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Tools in Good Condition:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('safety-tools')?.checked ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Work Area Clean:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('safety-area')?.checked ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Weather Conditions Safe:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('safety-weather')?.checked ? 'Yes' : 'No'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Emergency Info Available:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('safety-emergency')?.checked ? 'Yes' : 'No'}</td>
                        </tr>
                    </table>
                    <p style="margin-top: 10px;"><strong>Additional Notes:</strong> ${document.getElementById('safety-notes')?.value || 'N/A'}</p>
                </div>
            `;
        }
        
        function generateWorkOrderPDFContent() {
            return `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Document Information</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Date:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('document-date')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Crew Member:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('crew-member-name')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Job Site:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('job-site')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Work Order Details</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Work Description:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('work-description')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Materials Used:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('materials-used')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Hours Worked:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('hours-worked')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                    <p style="margin-top: 10px;"><strong>Work Notes:</strong> ${document.getElementById('work-notes')?.value || 'N/A'}</p>
                </div>
            `;
        }
        
        function generateIncidentReportPDFContent() {
            return `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Document Information</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Date:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('document-date')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Crew Member:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('crew-member-name')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Job Site:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('job-site')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Incident Report Details</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Incident Time:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('incident-time')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Severity:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('incident-severity')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                    <p style="margin-top: 10px;"><strong>Description:</strong> ${document.getElementById('incident-description')?.value || 'N/A'}</p>
                    <p style="margin-top: 10px;"><strong>Actions Taken:</strong> ${document.getElementById('incident-actions')?.value || 'N/A'}</p>
                </div>
            `;
        }
        
        function generateEquipmentInspectionPDFContent() {
            return `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Document Information</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Date:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('document-date')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Crew Member:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('crew-member-name')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Job Site:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('job-site')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Equipment Inspection Details</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Equipment Inspected:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('equipment-list')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Condition:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('inspection-condition')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Maintenance Needed:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('maintenance-needed')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                    <p style="margin-top: 10px;"><strong>Inspection Notes:</strong> ${document.getElementById('inspection-notes')?.value || 'N/A'}</p>
                </div>
            `;
        }
        
        function generateTimeSheetPDFContent() {
            return `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Document Information</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Date:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('document-date')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Crew Member:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('crew-member-name')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Job Site:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('job-site')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Time Sheet Details</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Start Time:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('start-time')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">End Time:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('end-time')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Break Time:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('break-time')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Total Hours:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('total-hours')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                    <p style="margin-top: 10px;"><strong>Work Activities:</strong> ${document.getElementById('work-activities')?.value || 'N/A'}</p>
                </div>
            `;
        }
        
        function generateMaterialRequestPDFContent() {
            return `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Document Information</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Date:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('document-date')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Crew Member:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('crew-member-name')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Job Site:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('job-site')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">Material Request Details</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold; width: 30%;">Materials Needed:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('materials-needed')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Priority Level:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('priority-level')?.value || 'N/A'}</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">Needed By:</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">${document.getElementById('needed-by')?.value || 'N/A'}</td>
                        </tr>
                    </table>
                    <p style="margin-top: 10px;"><strong>Request Reason:</strong> ${document.getElementById('request-reason')?.value || 'N/A'}</p>
                </div>
            `;
        }

        function hideDocumentFormModal() {
            document.getElementById('document-form-modal').style.display = 'none';
            document.getElementById('document-form').reset();
            delete document.getElementById('document-form').dataset.documentId;
            
            // Clear the document content to prevent duplicate IDs
            const documentContent = document.getElementById('document-content');
            if (documentContent) {
                documentContent.innerHTML = `
                    <div class="form-section">
                        <h4>📝 Document Content</h4>
                        <p style="color: #6c757d; font-style: italic;">Select a document type to load the template.</p>
                    </div>
                `;
            }
        }

        // Handle document form modal interactions
        document.addEventListener('keydown', function(e) {
            // Close document modal on Escape key
            if (e.key === 'Escape') {
                const docModal = document.getElementById('document-form-modal');
                if (docModal.style.display === 'flex') {
                    hideDocumentFormModal();
                }
            }
        });

        // Close document modal when clicking outside
        document.getElementById('document-form-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideDocumentFormModal();
            }
        });

        // Initialize session on page load
        restoreSession();
        
        // FLHA (Field Level Hazard Assessment) Functions
        function getRadioValue(name) {
            const radios = document.querySelectorAll(`input[name="${name}"]`);
            for (let radio of radios) {
                if (radio.checked) {
                    return radio.value;
                }
            }
            return '';
        }
        
        function collectFLHAData() {
            const flhaData = {
                // Basic Information
                name: document.getElementById('flha-name')?.value || '',
                date: document.getElementById('flha-date')?.value || '',
                time: document.getElementById('flha-time')?.value || '',
                weather: document.getElementById('flha-weather')?.value || '',
                siteAddress: document.getElementById('flha-site-address')?.value || '',
                taskArea: document.getElementById('flha-task-area')?.value || '',
                musterPoint: document.getElementById('flha-muster-point')?.value || '',
                safetyOfficerEmail: document.getElementById('safety-officer-email')?.value || '',
                
                // Documentation / Permits
                permitWork: document.getElementById('permit-work')?.checked || false,
                fireWatch: document.getElementById('fire-watch')?.checked || false,
                confinedSpace: document.getElementById('confined-space')?.checked || false,
                groundDisturbance: document.getElementById('ground-disturbance')?.checked || false,
                equipmentLogs: document.getElementById('equipment-logs')?.checked || false,
                lockout: document.getElementById('lockout')?.checked || false,
                fallProtection: document.getElementById('fall-protection')?.checked || false,
                criticalLift: document.getElementById('critical-lift')?.checked || false,
                
                // Working at Heights / Fall Hazards
                harnessRequired: document.getElementById('harness-required')?.checked || false,
                othersWorking: document.getElementById('others-working')?.checked || false,
                fallsHeight: document.getElementById('falls-height')?.checked || false,
                hoistingLoads: document.getElementById('hoisting-loads')?.checked || false,
                workingOverhead: document.getElementById('working-overhead')?.checked || false,
                objectsFalling: document.getElementById('objects-falling')?.checked || false,
                barricades: document.getElementById('barricades')?.checked || false,
                overheadObstructions: document.getElementById('overhead-obstructions')?.checked || false,
                fallProtectionLog: document.getElementById('fall-protection-log')?.checked || false,
                manbasket: document.getElementById('manbasket')?.checked || false,
                aerialLift: document.getElementById('aerial-lift')?.checked || false,
                otherHeights: document.getElementById('other-heights')?.checked || false,
                
                // Emergency Plan / Equipment
                emergencyPlan: document.getElementById('emergency-plan')?.checked || false,
                communication: document.getElementById('communication')?.checked || false,
                csoIdentified: document.getElementById('cso-identified')?.checked || false,
                eyeWash: document.getElementById('eye-wash')?.checked || false,
                
                // Protective Equipment
                respiratoryProtection: document.getElementById('respiratory-protection')?.checked || false,
                hardhatProtection: document.getElementById('hardhat-protection')?.checked || false,
                pfd: document.getElementById('pfd')?.checked || false,
                goggles: document.getElementById('goggles')?.checked || false,
                gloves: document.getElementById('gloves')?.checked || false,
                coveralls: document.getElementById('coveralls')?.checked || false,
                hearingProtection: document.getElementById('hearing-protection')?.checked || false,
                
                // Environmental Assessment
                spillResponse: document.getElementById('spill-response')?.checked || false,
                lightingLevels: document.getElementById('lighting-levels')?.checked || false,
                refuelingEquipment: document.getElementById('refueling-equipment')?.checked || false,
                erosionSediment: document.getElementById('erosion-sediment')?.checked || false,
                wildlife: document.getElementById('wildlife')?.checked || false,
                heatCold: document.getElementById('heat-cold')?.checked || false,
                silicaExposure: document.getElementById('silica-exposure')?.checked || false,
                weatherWind: document.getElementById('weather-wind')?.checked || false,
                tideCurrent: document.getElementById('tide-current')?.checked || false,
                wasteMaterial: document.getElementById('waste-material')?.checked || false,
                weldFumes: document.getElementById('weld-fumes')?.checked || false,
                
                // Limitations / Hazards
                procedureNotAvailable: document.getElementById('procedure-not-available')?.checked || false,
                confusingInstructions: document.getElementById('confusing-instructions')?.checked || false,
                noTrainingTask: document.getElementById('no-training-task')?.checked || false,
                noTrainingTools: document.getElementById('no-training-tools')?.checked || false,
                firstTimeTask: document.getElementById('first-time-task')?.checked || false,
                newWorker: document.getElementById('new-worker')?.checked || false,
                physicallyPrepared: document.getElementById('physically-prepared')?.checked || false,
                awkwardLoad: document.getElementById('awkward-load')?.checked || false,
                
                // Access / Egress
                scaffoldingApproved: document.getElementById('scaffolding-approved')?.checked || false,
                ladderSecured: document.getElementById('ladder-secured')?.checked || false,
                confinedSpaceEntry: document.getElementById('confined-space-entry')?.checked || false,
                
                // Other Hazards
                whmisSds: document.getElementById('whmis-sds')?.checked || false,
                electricalCords: document.getElementById('electrical-cords')?.checked || false,
                spottersCranes: document.getElementById('spotters-cranes')?.checked || false,
                riggingCertificates: document.getElementById('rigging-certificates')?.checked || false,
                hotWorkFirewatch: document.getElementById('hot-work-firewatch')?.checked || false,
                
                // Personnel Acknowledgement
                foremanSignature: document.getElementById('foreman-signature')?.value || '',
                foremanDate: document.getElementById('foreman-date')?.value || '',
                superintendentSignature: document.getElementById('superintendent-signature')?.value || '',
                superintendentDate: document.getElementById('superintendent-date')?.value || '',
                
                // End-of-Shift Review
                incidentsYes: document.getElementById('incidents-yes')?.checked || false,
                incidentsNo: document.getElementById('incidents-no')?.checked || false,
                incidentsWho: document.getElementById('incidents-who')?.value || '',
                reportedYes: document.getElementById('reported-yes')?.checked || false,
                reportedNo: document.getElementById('reported-no')?.checked || false,
                reportedTo: document.getElementById('reported-to')?.value || '',
                cleanedYes: document.getElementById('cleaned-yes')?.checked || false,
                cleanedNo: document.getElementById('cleaned-no')?.checked || false,
                concerns: document.getElementById('concerns')?.value || ''
            };
            
            return flhaData;
        }
        
        // FLHA Dynamic Table Functions
        function addHazardRow() {
            const table = document.getElementById("hazard-rows")?.querySelector("tbody");
            if (table) {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" style="width: 100%; border: none; outline: none;"></td>
                    <td style="border: 1px solid #ccc; padding: 8px;"><input type="text" style="width: 100%; border: none; outline: none;"></td>`;
                table.appendChild(row);
            }
        }

        function addSignatureRow() {
            const table = document.getElementById("crew-signatures")?.querySelector("tbody");
            if (table) {
                const rowCount = table.rows.length + 1;
                const row = document.createElement("tr");
                row.innerHTML = `<td style="border: 1px solid #ccc; padding: 8px;">${rowCount}</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" style="width: 100%; border: none; outline: none;"></td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" style="width: 100%; border: none; outline: none;"></td>`;
                table.appendChild(row);
            }
        }
        
        // SWP Helper Functions
        function collectSWPTasks() {
            const tasks = [];
            const taskInputs = document.querySelectorAll('#swp-tasks-table tbody tr td input');
            taskInputs.forEach(input => {
                if (input.value.trim()) {
                    tasks.push(input.value.trim());
                }
            });
            return tasks;
        }
        
        function collectSWPTools() {
            const tools = [];
            const toolInputs = document.querySelectorAll('#swp-tools-table tbody tr td input');
            toolInputs.forEach(input => {
                if (input.value.trim()) {
                    tools.push(input.value.trim());
                }
            });
            return tools;
        }
        
        function collectSWPProcedures() {
            const procedures = [];
            const procedureInputs = document.querySelectorAll('#swp-procedures-table tbody tr td input');
            procedureInputs.forEach(input => {
                if (input.value.trim()) {
                    procedures.push(input.value.trim());
                }
            });
            return procedures;
        }
        
        function collectSWPWorkers() {
            const workers = [];
            const workerRows = document.querySelectorAll('#swp-workers-table tbody tr');
            workerRows.forEach((row, index) => {
                const nameInput = row.querySelector('td:nth-child(2) input');
                const signatureInput = row.querySelector('td:nth-child(3) input');
                if (nameInput && signatureInput) {
                    workers.push({
                        number: index + 1,
                        name: nameInput.value.trim(),
                        signature: signatureInput.value.trim()
                    });
                }
            });
            return workers;
        }
        
        // SWP Dynamic Table Functions
        function addSWPTask() {
            const table = document.getElementById('swp-tasks-table').querySelector('tbody');
            const row = document.createElement('tr');
            const taskCount = table.rows.length + 1;
            row.innerHTML = '<td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="swp-task-' + taskCount + '" style="width: 100%; border: none; outline: none;"></td>';
            table.appendChild(row);
        }
        
        function addSWPTool() {
            const table = document.getElementById('swp-tools-table').querySelector('tbody');
            const row = document.createElement('tr');
            const toolCount = table.rows.length + 1;
            row.innerHTML = '<td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="swp-tool-' + toolCount + '" style="width: 100%; border: none; outline: none;"></td>';
            table.appendChild(row);
        }
        
        function addSWPProcedure() {
            const table = document.getElementById('swp-procedures-table').querySelector('tbody');
            const row = document.createElement('tr');
            const procedureCount = table.rows.length + 1;
            row.innerHTML = '<td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="swp-procedure-' + procedureCount + '" style="width: 100%; border: none; outline: none;"></td>';
            table.appendChild(row);
        }
        
        function addSWPWorker() {
            const table = document.getElementById('swp-workers-table').querySelector('tbody');
            const row = document.createElement('tr');
            const workerCount = table.rows.length + 1;
            row.innerHTML = '<td style="border: 1px solid #ccc; padding: 8px;">' + workerCount + '</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="swp-worker' + workerCount + '-name" style="width: 100%; border: none; outline: none;"></td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="swp-worker' + workerCount + '-signature" style="width: 100%; border: none; outline: none;"></td>';
            table.appendChild(row);
        }
        
        // SEP Helper Functions
        function collectSEPTasks() {
            const tasks = [];
            const taskInputs = document.querySelectorAll('#sep-tasks-table tbody tr td input');
            taskInputs.forEach(input => {
                if (input.value.trim()) {
                    tasks.push(input.value.trim());
                }
            });
            return tasks;
        }
        
        function collectSEPControls() {
            const controls = [];
            const controlInputs = document.querySelectorAll('#sep-controls-table tbody tr td input');
            controlInputs.forEach(input => {
                if (input.value.trim()) {
                    controls.push(input.value.trim());
                }
            });
            return controls;
        }
        
        function collectSEPTools() {
            const tools = [];
            const toolInputs = document.querySelectorAll('#sep-tools-table tbody tr td input');
            toolInputs.forEach(input => {
                if (input.value.trim()) {
                    tools.push(input.value.trim());
                }
            });
            return tools;
        }
        
        function collectSEPWorkers() {
            const workers = [];
            const workerRows = document.querySelectorAll('#sep-workers-table tbody tr');
            workerRows.forEach((row, index) => {
                const nameInput = row.querySelector('td:nth-child(2) input');
                const signatureInput = row.querySelector('td:nth-child(3) input');
                if (nameInput && signatureInput) {
                    workers.push({
                        number: index + 1,
                        name: nameInput.value.trim(),
                        signature: signatureInput.value.trim()
                    });
                }
            });
            return workers;
        }
        
        // SEP Dynamic Table Functions
        function addSEPTask() {
            const table = document.getElementById('sep-tasks-table').querySelector('tbody');
            const row = document.createElement('tr');
            const taskCount = table.rows.length + 1;
            row.innerHTML = '<td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="sep-task-' + taskCount + '" style="width: 100%; border: none; outline: none;"></td>';
            table.appendChild(row);
        }
        
        function addSEPControl() {
            const table = document.getElementById('sep-controls-table').querySelector('tbody');
            const row = document.createElement('tr');
            const controlCount = table.rows.length + 1;
            row.innerHTML = '<td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="sep-control-' + controlCount + '" style="width: 100%; border: none; outline: none;"></td>';
            table.appendChild(row);
        }
        
        function addSEPTool() {
            const table = document.getElementById('sep-tools-table').querySelector('tbody');
            const row = document.createElement('tr');
            const toolCount = table.rows.length + 1;
            row.innerHTML = '<td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="sep-tool-' + toolCount + '" style="width: 100%; border: none; outline: none;"></td>';
            table.appendChild(row);
        }
        
        function addSEPWorker() {
            const table = document.getElementById('sep-workers-table').querySelector('tbody');
            const row = document.createElement('tr');
            const workerCount = table.rows.length + 1;
            row.innerHTML = '<td style="border: 1px solid #ccc; padding: 8px;">' + workerCount + '</td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="sep-worker' + workerCount + '-name" style="width: 100%; border: none; outline: none;"></td><td style="border: 1px solid #ccc; padding: 8px;"><input type="text" id="sep-worker' + workerCount + '-signature" style="width: 100%; border: none; outline: none;"></td>';
            table.appendChild(row);
        }
    </script>
</body>
</html> 